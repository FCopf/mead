---
title: "Contando possibilidades"  
subtitle: "EvidÃªncias sobre uma hipÃ³tese"  
description: "IntroduÃ§Ã£o Ã  contagem de possibilidades na abordagem bayesiana. Baseado em *Statistical Rethinking* [@mcelreath2018statistical]."
Categories: [
          "InferÃªncia bayesiana",
          "DistribuiÃ§Ã£o a priori",
          "DistribuiÃ§Ã£o posterior"
        ]

image: "images/intro-bayes-conting.png"  
execute:  
  echo: true  
  warning: false  
  include: true  
  message: false  

---

---

A inferÃªncia bayesiana, em essÃªncia, Ã© uma forma de contar e comparar as diferentes maneiras pelas quais algo pode acontecer. A seguir, vamos desenvolver os princÃ­pios da inferÃªncia bayesiana de forma simples e intuitiva utilizando o princÃ­pio da contagem.

Imagine que temos uma caixa contendo **quatro** bolinhas de gude, que podem ser **azuis** ou **brancas**. Sabemos que hÃ¡ exatamente quatro bolinhas, mas nÃ£o conhecemos a distribuiÃ§Ã£o entre as cores. Com base nessa informaÃ§Ã£o, podemos listar cinco configuraÃ§Ãµes possÃ­veis:

1. [âšªâšªâšªâšª]  
2. [ğŸ”µâšªâšªâšª]  
3. [ğŸ”µğŸ”µâšªâšª]  
4. [ğŸ”µğŸ”µğŸ”µâšª]  
5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]

Essas sÃ£o todas as possibilidades compatÃ­veis com o que sabemos sobre o conteÃºdo da caixa â€” o conhecimento *a priori*. Chamamos essas cinco configuraÃ§Ãµes de **hipÃ³teses**.

Nosso objetivo serÃ¡ descobrir qual dessas hipÃ³teses Ã© mais plausÃ­vel Ã  medida que obtivermos evidÃªncias sobre o conteÃºdo da caixa.

## Um leque de possibilidades

A caixa possui um orifÃ­cio pelo qual podemos ver apenas uma bolinha por vez. Assim, a Ãºnica forma de obter evidÃªncias sobre o conteÃºdo da caixa serÃ¡ fazer uma observaÃ§Ã£o, misturar as bolinhas, fazer outra observaÃ§Ã£o e assim por diante. Antes de iniciar esse processo, vamos entender como cada observaÃ§Ã£o nos ajuda a alcanÃ§ar nosso objetivo, avaliando-as Ã  luz das hipÃ³teses sobre o conteÃºdo da caixa.

Vamos comeÃ§ar assumindo que seja verdadeira a situaÃ§Ã£o (2) [ğŸ”µâšªâšªâšª]. Nesse caso, terÃ­amos 1 possibilidade de observar a bolinha azul e 3 possibilidades de observar uma bolinha branca (@fig-leque1).

![As quatro possibilidades, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Diagrama-possibilidades-1.png){#fig-leque1 width=20% style="display: block; margin-left: auto; margin-right: auto;"}

::: {.callout-tip title="Dica Ãºtil"}
Observe que, embora as trÃªs bolinhas brancas pareÃ§am iguais do ponto de vista dos dados (pois apenas registramos suas cores), elas sÃ£o eventos **diferentes**. Isso Ã© importante, pois significa que hÃ¡ trÃªs maneiras a mais de observar âšª do que ğŸ”µ.
:::

Observamos agora uma *segunda* bolinha. Isso expande nosso leque de possibilidades em mais uma camada (@fig-leque2). Agora existem 16 caminhos possÃ­veis (um para cada par de observaÃ§Ãµes), pois, na segunda observaÃ§Ã£o, cada um dos caminhos anteriores se ramifica em outros quatro caminhos possÃ­veis.

![Os 16 caminhos possÃ­veis, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Diagrama-possibilidades-2.png){#fig-leque2 width=40% style="display: block; margin-left: auto; margin-right: auto;"}

Ao observar uma *terceira* bolinha da caixa, a terceira camada Ã© construÃ­da da mesma forma, e agora temos $4^3 = 64$ caminhos possÃ­veis para uma sequÃªncia de observaÃ§Ãµes de cores em uma caixa com 4 bolinhas (@fig-leque3).

![Os 64 caminhos possÃ­veis, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Fig-2-2.png){#fig-leque3 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

::: {.callout-warning title="Pressuposto Importante"}
Acreditamos que, ao sacudir a caixa, cada bolinha tem a mesma chance de ser observada pelo orifÃ­cio, independentemente de qual tenha saÃ­do anteriormente. Por isso, cada caminho do leque Ã© igualmente provÃ¡vel de ser observado.
:::

## Avaliando as evidÃªncias

Ã€ medida que observamos a cor de uma nova bolinha da caixa, alguns desses caminhos sÃ£o logicamente eliminados. 

Suponha que a sequÃªncia de cores observada tenha sido:  

**1Âª bolinha:** ğŸ”µ  
**2Âª bolinha:** âšª  
**3Âª bolinha:** ğŸ”µ

ApÃ³s a primeira retirada resultar em ğŸ”µ, os trÃªs caminhos que levariam Ã  observaÃ§Ã£o de uma bolinha branca na primeira camada sÃ£o imediatamente eliminados. Na segunda retirada, obtivemos âšª, de modo que um dos caminhos possÃ­veis na segunda camada foi eliminado, restando os trÃªs caminhos que se ramificam a partir do primeiro caminho azul. ApÃ³s a terceira observaÃ§Ã£o, cada um dos trÃªs caminhos restantes na segunda camada segue somente para a bolinha azul na terceira camada. Assim, assumindo que a caixa contenha [ğŸ”µâšªâšªâšª], existe um total de trÃªs maneiras para a sequÃªncia [ğŸ”µ â†’ âšª â†’ ğŸ”µ] aparecer. Todas as outras possibilidades foram descartadas Ã  medida que as evidÃªncias surgiam.

Dos caminhos restantes na @fig-2-3, nÃ£o podemos ter certeza de qual dos trÃªs caminhos os dados reais seguiram, pois nÃ£o podemos identificar as bolinhas individualmente, apenas por sua cor. Entretanto, considerando a hipÃ³tese de que a caixa contenha [ğŸ”µâšªâšªâšª], podemos afirmar que os dados seguiram um desses trÃªs caminhos, pois sÃ£o os Ãºnicos compatÃ­veis tanto com nosso conhecimento prÃ©vio (4 bolinhas, azuis ou brancas) quanto com a sequÃªncia de dados observada ([ğŸ”µ â†’ âšª â†’ ğŸ”µ]).

![ApÃ³s eliminar caminhos inconsistentes com a sequÃªncia observada, apenas 3 dos 64 caminhos permanecem. ExtraÃ­do de @mcelreath2018statistical.](images/Fig-2-3.png){#fig-2-3 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

## Avaliando as demais hipÃ³teses

Considerando que a caixa contenha [ğŸ”µâšªâšªâšª], verificamos que apenas trÃªs dos 64 caminhos possÃ­veis poderiam gerar a sequÃªncia [ğŸ”µ â†’ âšª â†’ ğŸ”µ]. Falta agora aplicar a mesma lÃ³gica Ã s demais hipÃ³teses. Por exemplo, considere [âšªâšªâšªâšª]. HÃ¡ zero maneiras de essa hipÃ³tese produzir os dados observados, pois uma Ãºnica ğŸ”µ jÃ¡ Ã© logicamente incompatÃ­vel com ela. A hipÃ³tese [ğŸ”µğŸ”µğŸ”µğŸ”µ] tambÃ©m nÃ£o pode produzir a sequÃªncia, pois hÃ¡ ao menos uma âšª observada. Assim, podemos eliminar essas duas hipÃ³teses, pois nenhuma delas fornece sequer um Ãºnico caminho consistente com os dados.

Para as hipÃ³teses restantes, isto Ã©, [ğŸ”µğŸ”µâšªâšª] e [ğŸ”µğŸ”µğŸ”µâšª], o leque de possibilidades se abre novamente.

A @fig-leque4 mostra o leque completo para as trÃªs hipÃ³teses compatÃ­veis com os dados observados: [ğŸ”µâšªâšªâšª], [ğŸ”µğŸ”µâšªâšª] e [ğŸ”µğŸ”µğŸ”µâšª].

![Caminhos de composiÃ§Ã£o possÃ­vel para cada hipÃ³tese logicamente compatÃ­vel com a sequÃªncia observada. ExtraÃ­do de @mcelreath2018statistical.](images/Fig-2-4.png){#fig-leque4 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

Agora, contamos todas as maneiras pelas quais cada hipÃ³tese poderia produzir os dados observados. Para uma bolinha azul e trÃªs brancas, existem trÃªs maneiras (como jÃ¡ contamos). Para duas bolinhas azuis e duas brancas, hÃ¡ oito caminhos consistentes com a sequÃªncia. Para trÃªs bolinhas azuis e uma branca, hÃ¡ nove caminhos que sobrevivem Ã s observaÃ§Ãµes.

Consideramos, assim, as cinco hipÃ³teses diferentes sobre o conteÃºdo da caixa, variando de zero bolinhas ğŸ”µ a quatro bolinhas ğŸ”µ e, para cada uma dessas hipÃ³teses, contamos quantas possibilidades (ou â€œcaminhosâ€) poderiam potencialmente produzir a sequÃªncia observada.

| **HipÃ³tese**    | **Maneiras de produzir [ğŸ”µ â†’ âšª â†’ ğŸ”µ]** |
|-----------------|-----------------------------------------|
| 1. [âšªâšªâšªâšª]      | $0 \times 4 \times 0 = 0$               |
| 2. [ğŸ”µâšªâšªâšª]      | $1 \times 3 \times 1 = 3$               |
| 3. [ğŸ”µğŸ”µâšªâšª]      | $2 \times 2 \times 2 = 8$               |
| 4. [ğŸ”µğŸ”µğŸ”µâšª]      | $3 \times 1 \times 3 = 9$               |
| 5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]      | $4 \times 0 \times 4 = 0$               |

: **Total de maneiras pelas quais cada hipÃ³tese pode gerar a sequÃªncia [ğŸ”µ â†’ âšª â†’ ğŸ”µ].** {#tbl-caminhos1}

Observe que o nÃºmero de maneiras de produzir os dados, para cada hipÃ³tese, pode ser obtido contando as ramificaÃ§Ãµes em cada camada do leque de possibilidades e, em seguida, multiplicando esses valores (@tbl-caminhos1). Isso Ã© apenas um recurso computacional. Ele nos diz a mesma coisa que a @fig-leque4, mas sem precisar desenhar todo o diagrama. O fato de multiplicarmos os nÃºmeros nÃ£o altera o sentido de estarmos apenas contando caminhos logicamente possÃ­veis.

## Atualizando o conhecimento

Suponha que o experimento anterior, sumarizado na @tbl-caminhos1, tenha sido finalizado. Isso nos diz que, por ora, temos evidÃªncias melhores para as hipÃ³teses 3 e 4, isto Ã©, de que a caixa contenha 2 ou 3 bolinhas azuis. Para ajudar a diferenciar essas duas possibilidades ainda mais, resolvemos continuar o experimento e amostrar outra bolinha, o que resultou na observaÃ§Ã£o de uma bolinha azul. Como se trata de um novo experimento, poderÃ­amos recomeÃ§ar todo o processo. No entanto, hÃ¡ uma forma melhor de aproveitar o conhecimento adquirido *a priori* â€” para cada hipÃ³tese, listamos as maneiras anteriores de produzir as observaÃ§Ãµes (o *prior*) e multiplicamos pelo nÃºmero de maneiras de produzir a nova evidÃªncia ğŸ”µ:

| **HipÃ³tese**        | **Contagem anterior (prior)** | **Maneiras de produzir a nova observaÃ§Ã£o ğŸ”µ** | **Contagem posterior** |
|---------------------|:-----------------------------:|:---------------------------------------------:|:------------------------:|
| 1. [âšªâšªâšªâšª]         | 0                             | 0                                           | $0 \times 0 = 0$         |
| 2. [ğŸ”µâšªâšªâšª]         | 3                             | 1                                           | $3 \times 1 = 3$         |
| 3. [ğŸ”µğŸ”µâšªâšª]         | 8                             | 2                                           | $8 \times 2 = 16$        |
| 4. [ğŸ”µğŸ”µğŸ”µâšª]         | 9                             | 3                                           | $9 \times 3 = 27$        |
| 5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]         | 0                             | 4                                           | $0 \times 4 = 0$         |

: **Total de maneiras pelas quais cada hipÃ³tese pode gerar a sequÃªncia completa [ğŸ”µ â†’ âšª â†’ ğŸ”µ â†’ ğŸ”µ], combinando a contagem anterior com a nova evidÃªncia.** {#tbl-caminhos2}

A nova contagem na coluna da direita da @tbl-caminhos2 resume as evidÃªncias a favor de cada hipÃ³tese, de modo que sejam compatÃ­veis tanto com as observaÃ§Ãµes anteriores quanto com a nova observaÃ§Ã£o. Portanto, Ã  medida que novos dados chegam e, desde que sejam independentes dos anteriores, o total de caminhos logicamente possÃ­veis para explicar tanto as observaÃ§Ãµes antigas quanto as novas pode ser calculado pela multiplicaÃ§Ã£o das contagens anteriores pelas novas.

Em outras palavras, sempre que temos $W_\text{prior}$ maneiras de uma hipÃ³tese produzir observaÃ§Ãµes anteriores ($D_\text{prior}$) e, em seguida, obtemos novas observaÃ§Ãµes ($D_\text{novo}$) que essa mesma hipÃ³tese pode produzir de $W_\text{novo}$ maneiras, a quantidade total de formas possÃ­veis para essa hipÃ³tese explicar tanto os dados antigos quanto os novos Ã© dada simplesmente por $W_\text{prior} \times W_\text{novo}$. Por exemplo, na @tbl-caminhos2, a hipÃ³tese [ğŸ”µğŸ”µâšªâšª] apresenta $W_\text{prior} = 8$ maneiras de gerar as observaÃ§Ãµes anteriores [ğŸ”µ â†’ âšª â†’ ğŸ”µ] e $W_\text{novo} = 2$ maneiras de gerar a nova observaÃ§Ã£o [ğŸ”µ]. Logo, $8 \times 2 = 16$ caminhos possÃ­veis para explicar tanto os dados antigos quanto os novos.

::: {.callout-warning title="Combinando evidÃªncias"}
No exemplo acima, os dados antigos e os novos sÃ£o do mesmo tipo (bolinhas observadas na caixa). Entretanto, nÃ£o hÃ¡ motivo para excluir a situaÃ§Ã£o em que os dados antigos e os novos tenham sido obtidos de forma diferente. Suponha, por exemplo, que alguÃ©m da fÃ¡brica de bolinhas informe que as azuis sÃ£o raras. Para cada caixa contendo [ğŸ”µğŸ”µğŸ”µâšª], a fÃ¡brica produz duas caixas contendo [ğŸ”µğŸ”µâšªâšª] e trÃªs caixas contendo [ğŸ”µâšªâšªâšª]. TambÃ©m garante que cada caixa contenha pelo menos uma bolinha azul e uma bolinha branca. Com essa nova informaÃ§Ã£o, podemos atualizar nossas contagens novamente (@tbl-caminhos3).

| **HipÃ³tese**     | **Contagem anterior (prior)** | **Maneiras de produzir ğŸ”µ informadas pela fÃ¡brica** | **Nova contagem** |
|------------------|:-----------------------------:|:----------------------------------------------------:|:-----------------:|
| 1. [âšªâšªâšªâšª]         | 0                              | 0                                                   | $0 \times 0 = 0$  |
| 2. [ğŸ”µâšªâšªâšª]         | 3                              | 3                                                   | $3 \times 3 = 9$  |
| 3. [ğŸ”µğŸ”µâšªâšª]         | 16                             | 2                                                   | $16 \times 2 = 32$|
| 4. [ğŸ”µğŸ”µğŸ”µâšª]         | 27                             | 1                                                   | $27 \times 1 = 27$|
| 5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]         | 0                              | 0                                                   | $0 \times 0 = 0$  |

: **Contagens atualizadas apÃ³s incorporar a nova observaÃ§Ã£o ğŸ”µ e as informaÃ§Ãµes externas sobre a frequÃªncia das hipÃ³teses.** {#tbl-caminhos3}

Agora, Ã  luz dessa informaÃ§Ã£o adicional, a hipÃ³tese [ğŸ”µğŸ”µâšªâšª] torna-se ligeiramente mais plausÃ­vel do que [ğŸ”µğŸ”µğŸ”µâšª].

:::