<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Métodos de amostragem aleatória simples, estratificada e sistemática, destacando o erro amostral e a acurácia das estimativas.">

<title>Amostrando uma população estatística – Modelagem Estatística e Análise de Dados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/custom.css">
<meta property="og:title" content="Amostrando uma população estatística – Modelagem Estatística e Análise de Dados">
<meta property="og:description" content="Métodos de amostragem aleatória simples, estratificada e sistemática, destacando o erro amostral e a acurácia das estimativas.">
<meta property="og:image" content="https://github.com/FCopf/MEAD/content/amostragem/images/tipos-amostragem.jpg">
<meta property="og:site_name" content="Modelagem Estatística e Análise de Dados">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/MEAD-logo-white-sigla.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Modelagem Estatística e Análise de Dados</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/FCopf/MEAD"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Nesta página</h2>
   
  <ul>
  <li><a href="#amostragem-aleatória-simples" id="toc-amostragem-aleatória-simples" class="nav-link active" data-scroll-target="#amostragem-aleatória-simples"><span class="header-section-number">1</span> Amostragem aleatória simples</a></li>
  <li><a href="#amostragem-aleatória-estratificada" id="toc-amostragem-aleatória-estratificada" class="nav-link" data-scroll-target="#amostragem-aleatória-estratificada"><span class="header-section-number">2</span> Amostragem aleatória estratificada</a></li>
  <li><a href="#amostragem-sistemática" id="toc-amostragem-sistemática" class="nav-link" data-scroll-target="#amostragem-sistemática"><span class="header-section-number">3</span> Amostragem sistemática</a></li>
  <li><a href="#erro-amostral-acurácia-e-precisão" id="toc-erro-amostral-acurácia-e-precisão" class="nav-link" data-scroll-target="#erro-amostral-acurácia-e-precisão"><span class="header-section-number">4</span> Erro amostral, acurácia e precisão</a>
  <ul class="collapse">
  <li><a href="#erro-amostral" id="toc-erro-amostral" class="nav-link" data-scroll-target="#erro-amostral"><span class="header-section-number">4.1</span> Erro amostral</a></li>
  <li><a href="#acurácia" id="toc-acurácia" class="nav-link" data-scroll-target="#acurácia"><span class="header-section-number">4.2</span> Acurácia</a></li>
  <li><a href="#precisão-o-erro-padrão-da-média-sigma_overlinex" id="toc-precisão-o-erro-padrão-da-média-sigma_overlinex" class="nav-link" data-scroll-target="#precisão-o-erro-padrão-da-média-sigma_overlinex"><span class="header-section-number">4.3</span> Precisão: o erro padrão da média (<span class="math inline">\(\sigma_{\overline{X}}\)</span>)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Amostrando uma população estatística</h1>
</div>

<div>
  <div class="description">
    Métodos de amostragem aleatória simples, estratificada e sistemática, destacando o erro amostral e a acurácia das estimativas.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pacotes, funções e base de dados utilizadas no capítulo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Pacotes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>O objetivo da amostragem é descrever características da <strong>população estatística</strong> por meio de características da <strong>amostra</strong>. Por exemplo, em um estudo sobre o tamanho do pescado em uma área de pesca, a população estatística são os comprimentos de todos os peixes que podem ser pescados na região. A população estatística pode ser descrita por <strong>parâmetros</strong> que representam medidas de centro como o comprimento médio (<span class="math inline">\(\mu\)</span>), ou por medidas de variação como o desvio padrão (<span class="math inline">\(\sigma\)</span>), que representam o grau de dispersão das unidades amostrais ao redor da média. Se amostramos <strong>n</strong> elementos desta população, a média amostral (<span class="math inline">\(\overline{X}\)</span>) e o desvio padrão amostral (<span class="math inline">\(s\)</span>) dos diâmetros serão os estimadores destas características.</p>
<p>Dependendo da questão envolvida e do conhecimento prévio sobre a população, diferentes métodos de amostragem são apropriados. A <strong>teoria da amostragem</strong> é a área da ciência que estuda estes métodos. Neste capítulo vamos discutir três tipos de amostragem: <strong>aleatória simples</strong>, <strong>estratificada</strong> e <strong>sistemática</strong>.</p>
<section id="amostragem-aleatória-simples" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="amostragem-aleatória-simples"><span class="header-section-number">1</span> Amostragem aleatória simples</h2>
<p>É aquela em que cada elemento da população tem a mesma probabilidade de ser selecionado para compor a amostra. Se a população consiste de <span class="math inline">\(1000\)</span> elementos, cada um terá uma probabilidade de <span class="math inline">\(\frac{1}{1000}\)</span> de ser escolhido. Isto isenta o pesquisador de tomar qualquer decisão com base em julgamentos pré-concebidos, sobre quais elementos devem ou não compor a amostra.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(pop)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Am1 <span class="ot">=</span> <span class="fu">sort</span>(pop)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Am2 <span class="ot">=</span> <span class="fu">sample</span>(pop, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">replace =</span> F)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Suponha uma população hipotética de somente <span class="math inline">\(10\)</span> elementos:</p>
<p><strong>População</strong>: 3, 10, 14, 19, 27, 28, 29, 41, 42, 43</p>
<p>Em uma amostra aleatória simples de cinco elementos, qualquer combinação destes <span class="math inline">\(10\)</span> elementos é <strong>igualmente provável</strong>. Se por puro acaso sortearmos uma amostra aleatória contendo os cinco menores valores da população:</p>
<p><strong>Amostra 1</strong>: 3, 10, 14, 19, 27</p>
<p>A amostra seria <strong>tão aleatória</strong> e válida do ponto de vista estatístico quanto qualquer outra como:</p>
<p><strong>Amostra 2</strong>: 27, 28, 42, 3, 43</p>
<p>Isto significa que uma amostra aleatória pode não ser <strong>necessariamente</strong> representativa da população. Amostras pequenas por exemplo, têm uma chance maior de selecionar apenas valores extremos, ou seja, os maiores ou menores elementos da população. A média amostral (<span class="math inline">\(\overline{X}\)</span>) calculada para estas amostras estará distante da média populacional (<span class="math inline">\(\mu\)</span>). No entanto, a importância central da amostragem aleatória em estatística está no fato de que a aleatoriedade produz, <strong>em média</strong>, amostras representativas da população. Deste modo, é esperado que na maioria das vezes, uma amostra aleatória gere médias amostrais próximas à média populacional. Por este motivo, é fundamental prezar pela aleatoriedade no processo amostral, pois de outro modo não poderemos garantir que a inferência seja válida com base nas leis de probabilidade.</p>
<p>O modo mais direto de se obter uma amostra aleatória é por meio de sorteio. Após atribuir números de 1 a <span class="math inline">\(N\)</span> a cada unidade amostral, estas unidades são sorteadas até que seja atingido o tamanho <span class="math inline">\(n\)</span> desejado. Na prática, nem sempre é simples, ou mesmo possível obter uma amostra aleatória nestes moldes. Não seria possível enumerar todos os peixes de uma região para, após um sorteio, tomar as medidas somente dequeles selecionados. Entretanto, se empregarmos métodos de captura em que indivíduos de todos os tamanhos sejam igualmente sujeitos a serem capturados poderíamos no <em>aproximar</em> do que seria uma amostra verdsadeiramente aleatória. Outras dificuldades práticas surgiriam neste estudo como por exemplo: garantir acesso irrestrito à toda a área de ocorrência da espécie, tempo disponível para percorrer a toda região. Questões como estas não desmerecem o requisito básico de se obter uma amostra aleatória, mas devem nos auxiliar a decidir como conciliar a prática experimental com a necessidade de garantirmos uma amostra aleatória.</p>
</section>
<section id="amostragem-aleatória-estratificada" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="amostragem-aleatória-estratificada"><span class="header-section-number">2</span> Amostragem aleatória estratificada</h2>
<p>Se tivermos algum conhecimento prévio de como a população está estruturada, a amostra aleatória simples, embora não esteja incorreta, pode não ser a estratégia mais eficiente do ponto de vista estatístico. Se for possivel identificar <strong>estratos</strong> ou <strong>subgrupos</strong> dentro da população, podemos conduzir uma <strong>amostragem aleatória estatificada</strong>.</p>
<p>Voltemos ao exemplo do comprimento do pescado. Suponha que existam duas áreas de ocorrência da espécie. Uma delas sujeita a intensa atividade pesqueira e outra sendo uma área protegida. Poderíamos supor que na área protegida estejam os maiores indivíduos, justamente porque nesta área não há atividade de pesca (que em geral busca indivíduos maiores). Dizemos que os comprimentos em cada uma das duas regiões compõem estratos da população estatística.</p>
<p>Nesta situação, uma amostra puramente aleatória <strong>sem considerar</strong> a existência dos dois estratos pode fazer com que, puramente ao acaso, um deles se torne mais representados na amostra. Se por exemplo da maioria dos pontos selecionados estiverem na região intensamente pescada, o comprimento médio da amostra (<span class="math inline">\(\overline{X}\)</span>) tenderá a ficar consistentemente abaixo de <span class="math inline">\(\mu\)</span>. A chance disto ocorrer se torna maior principalmente se o tamanho amostral for pequeno.</p>
<p>Entretanto, se a seleção dos indivíduos foi feita por meio de sorteio, o simples fato de observarmos este padrão não seria por si só justificativa para refarzermos a amostra. O ponto relevante aqui é que em uma amostra aleatória simples, estes extremos indesejáveis (um estrato mais representado que outro) são mais prováveis de acontecer.</p>
<p>Se temos conhecimento da existência dos dois estratos portanto, a amostragem aleatória <strong>estratificada</strong> seria a mais indicada. Neste tipo de amostragem, o esforço amostral é subdividido entre os estratos. O tamanho amostral em cada estrato será o mesmo, ou <strong>proporcional</strong> ao seu tamanho. Uma vez definirmos os tamanhos amostrais que será aplicado aos estratos, as unidades são selecionadas por meio de uma amostragem aleatória simples em cada um.</p>
<p>A amostragem aleatória estratificada garante que <strong>todos</strong> os estratos estejam presentes na amostra conforme sua representatividade na população. Ao fazer isto, as estimativas da amostra tenderão a se concentrar mais próximas ao parâmetro da população. Deste modo, quando os estratos são identificados <strong>corretamente</strong>, a principal vantagem da amostra aleatória estratificada sobre a amostra aleatória simples está em aumentar a <strong>precisão</strong> das estimativas. Mais a frente iremos discutir os conceitos de precisão e acurácia e relacioná-los com as estratégias amostrais discutidas aqui.</p>
</section>
<section id="amostragem-sistemática" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="amostragem-sistemática"><span class="header-section-number">3</span> Amostragem sistemática</h2>
<p>Em uma amostragem sistemática o pesquisador escolhe um elemento inicial e toma medidas a cada <span class="math inline">\(k\)</span> ocorrências, seguindo a ordem de observação. No caso do comprimento de pescado, para facilitar a tomada de dados, o pesquisador pode medir o primeiro peixe coletado e, em seguida, medir os peixes em intervalos regulares, por exemplo a cada <span class="math inline">\(10\)</span> observados.</p>
<p>A escolha da amostragem sistemática ao invés de uma amostragem aleatória simples, deve-se à sua praticidade. Se a característica de interesse das unidades amostrais estiver disposta de forma aleatória ao longo da sequência escolhida, a amostragem aleatória e sistemática irão gerar resultados similares. Na maioria dos casos, é isto que o pesquisador assume (ainda que implicitamente) quando opta por uma amostragem sistemática.</p>
</section>
<section id="erro-amostral-acurácia-e-precisão" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="erro-amostral-acurácia-e-precisão"><span class="header-section-number">4</span> Erro amostral, acurácia e precisão</h2>
<p>Como as estimativas são obtidas de um subconjunto da população (a amostra), é regra que o resultado obtido de uma amostra aleatória particular, não será igual ao verdadeiro valor da população (o parâmetro), embora exista uma grande probabilidade estar próximo.</p>
<ul>
<li><strong>Erro amostral</strong>: é a diferença entre uma estimativa em particular e o parâmetro na população e portanto, é inerente à variabilidade do processo de amostragem. Suponha que, puramente ao acaso, a amostra inclua os menores elementos da população. A média amostral (<span class="math inline">\(\overline{X}\)</span>) estará muito abaixo da média populacional (<span class="math inline">\(\mu\)</span>) e o erro amostral será grande. Se calcularmos a média (<span class="math inline">\(\overline{X}\)</span>) de uma amostra particular, o erro amostral será dado por:</li>
</ul>
<p><span class="math display">\[E = \overline{X} - \mu\]</span></p>
<p>A estatística estuda o comportamento probabilístico dos erros amostrais. Existe também o <strong>erro não amostral</strong> que decorre de equívocos de amostragem, inexperiência do amostrador, falha de equipamentos, enganos no cômputo dos resultados, etc. A estatística <strong>não lida</strong> com este tipo de erro.</p>
<ul>
<li><strong>Acurácia</strong>: se refere à proximidade entre o parâmetro e o estimador. Um estimador acurado é, em média, igual ao parâmetro populacional. Diferente do erro amostral, a acurácia não se refere a uma estimativa em particular, mas ao valor <strong>esperado</strong> do estimador, caso a amostragem fosse repetida um grande número de vezes. Um estimador não-acurado (<strong>viciado</strong>) resulta em valores <strong>consistentemente</strong> diferentes do parâmetro, podendo estar acima (<strong>viés positivo</strong>) ou abaixo (<strong>viés negativo</strong>) do valor populacional. A média aritmética amostral (<span class="math inline">\(\overline{X}\)</span>) é um estimador não-viciado da média populacional (<span class="math inline">\(\mu\)</span>) pois:</li>
</ul>
<p><span class="math display">\[\mu_{\overline{X}} = \mu\]</span></p>
<ul>
<li><strong>Precisão</strong>: tem relação com a variabilidade do estimador. Estimadores que geram estimativas similares entre si são mais precisos. Porém, se as estimativas estiverem distantes de sua média, o estimador é dito pouco preciso. <strong>Exemplo</strong>: Para uma população normalmente distribuída, tanto a média aritmética quanto a mediana são estimadores acurados. Entretanto, a variância da mediana é maior que da média aritmética. Dizemos portanto, que a média aritmética é um estimador mais preciso que a mediana. A precisão de um estimador é medida pelo <strong>erro padrão da média</strong>.</li>
</ul>
<p><span class="math display">\[\sigma_{\overline{X}} =\frac{\sigma}{\sqrt{n}}\]</span></p>
<p>A figura abaixo é comnmente utilizada para representar os conceitos de precição e acurácia. O centro do alvo é o valor do parâmetro populacional e os pontos em preto são as estimativas. Estimadores acurados geram, em média, estimativas ao redor do parâmetro populacional (viés <span class="math inline">\(= 0\)</span>). Estimadores <strong>não-acurados</strong> geram, em média, valores deslocados do parâmetro populacional (viés <span class="math inline">\(\ne 0\)</span>). Estimadores precisos resultam sempre em estimativas próximas entre si, enquanto estimadores não precisos resultam em estimativas distantes umas das outras.</p>
<div id="fig-precis-acur" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-precis-acur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgages/precisao-acuracia.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-precis-acur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Representação dos conceitos de precisão e acurácia.
</figcaption>
</figure>
</div>
<section id="erro-amostral" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="erro-amostral"><span class="header-section-number">4.1</span> Erro amostral</h3>
<p>Voltemos à nossa população fictícia com <span class="math inline">\(N = 10\)</span> elementos:</p>
<p><strong>População</strong>: 3, 10, 14, 19, 27, 28, 29, 41, 42, 43</p>
<p>Para esta população em particular nós conhecemos a média populacional (<span class="math inline">\(\mu\)</span> = 25.6), de modo que será possível compará-la com as estimativas amostrais.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Am1 <span class="ot">=</span> <span class="fu">sample</span>(pop, <span class="at">size =</span> n, <span class="at">replace =</span> F)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>somaAm1 <span class="ot">=</span> <span class="fu">paste</span>(Am1, <span class="at">collapse =</span> <span class="st">"+"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mp <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(pop),<span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mAm1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Am1),<span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">=</span> mAm1 <span class="sc">-</span> mp</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vamos tomar uma amostra aleatória de tamanho <span class="math inline">\(n = 5\)</span>:</p>
<p><strong>Amostra 1</strong>: <span class="math inline">\(41, 14, 42, 29, 19\)</span></p>
<p>Para esta amostra, a média vale: <span class="math inline">\(\overline{X} =\frac{41+14+42+29+19}{5} = 29\)</span>.</p>
<p>Os valores <span class="math inline">\(\mu = 25.6\)</span> e <span class="math inline">\(\overline{X} = 29\)</span> não são idênticos, pois a amostra contém somente alguns elementos da população. A diferença entre <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\overline{X}\)</span> é o chamamos de <strong>erro amostral</strong>.</p>
<p>Neste caso, o erro amostral é:</p>
<p><strong>Erro amostral 1</strong>: <span class="math inline">\(E_1 = 29  -  25.6  =  3.4\)</span></p>
<p>Se tomarmos outra amostra aleatória, teremos outro conjunto de unidades amostrais, e consequentemente, um <span class="math inline">\(\overline{X}\)</span> e um erro amostral diferentes. Por exemplo:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Am2 <span class="ot">=</span> <span class="fu">sample</span>(pop, <span class="at">size =</span> n, <span class="at">replace =</span> F)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>mAm2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Am2),<span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">=</span> mAm2 <span class="sc">-</span> mp</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Amostra 2</strong>: <span class="math inline">\(27, 29, 19, 10, 14\)</span></p>
<p><strong>Média amostral 2</strong>: <span class="math inline">\(\overline{X_2} = 19.8\)</span></p>
<p><strong>Erro amostral 2</strong>: <span class="math inline">\(E_2 = 19.8  -  25.6  =  -5.8\)</span></p>
</section>
<section id="acurácia" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="acurácia"><span class="header-section-number">4.2</span> Acurácia</h3>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(pop)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>CT <span class="ot">=</span> <span class="fu">choose</span>(N,n)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Até agora, analisamos duas amostras diferentes da população. Porém, quantas amostras distintas seriam possíveis? Para uma amostragem <strong>sem reposição</strong>, a teoria combinatória nos diz que são possíveis:</p>
<p><span class="math display">\[{{10}\choose{5}} = \frac{10!}{(10-5)! \times 5!} = 252\]</span></p>
<p>formas diferentes de combinarmos <span class="math inline">\(N = 10\)</span> elementos em amostras de tamanho <span class="math inline">\(n = 5\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>A15 <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> R, <span class="fu">sample</span>(pop, <span class="at">size =</span> n, <span class="at">replace =</span> F))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(A15) <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"A"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(A15), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Medias <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">apply</span>(A15, <span class="dv">2</span>, mean),<span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Inicialmente vamos avaliar a questão com um número menor. Sejam por exemplo, 8 amostras tomadas aleatoriamente, gerando os resultados a seguir:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>A15 <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="st">'Obs'</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="st">''</span>, <span class="at">times =</span> <span class="fu">nrow</span>(A15)), <span class="at">.before =</span> <span class="st">'A1'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="at">Obs =</span> <span class="fu">c</span>(<span class="st">'Médias'</span>, Medias)) <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>)),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Obs <span class="sc">==</span> <span class="st">"Médias"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">everything</span>() <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">150</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-amostr-pop" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-amostr-pop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;1: Oito amostras de tamanho n = 5 da população estatística.
</figcaption>
<div aria-describedby="tbl-amostr-pop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xefjlcyhds" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xefjlcyhds table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xefjlcyhds thead, #xefjlcyhds tbody, #xefjlcyhds tfoot, #xefjlcyhds tr, #xefjlcyhds td, #xefjlcyhds th {
  border-style: none;
}

#xefjlcyhds p {
  margin: 0;
  padding: 0;
}

#xefjlcyhds .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xefjlcyhds .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xefjlcyhds .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xefjlcyhds .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xefjlcyhds .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xefjlcyhds .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xefjlcyhds .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xefjlcyhds .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xefjlcyhds .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xefjlcyhds .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xefjlcyhds .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xefjlcyhds .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xefjlcyhds .gt_spanner_row {
  border-bottom-style: hidden;
}

#xefjlcyhds .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xefjlcyhds .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xefjlcyhds .gt_from_md > :first-child {
  margin-top: 0;
}

#xefjlcyhds .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xefjlcyhds .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xefjlcyhds .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xefjlcyhds .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xefjlcyhds .gt_row_group_first td {
  border-top-width: 2px;
}

#xefjlcyhds .gt_row_group_first th {
  border-top-width: 2px;
}

#xefjlcyhds .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xefjlcyhds .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xefjlcyhds .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xefjlcyhds .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xefjlcyhds .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xefjlcyhds .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xefjlcyhds .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xefjlcyhds .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xefjlcyhds .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xefjlcyhds .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xefjlcyhds .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xefjlcyhds .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xefjlcyhds .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xefjlcyhds .gt_left {
  text-align: left;
}

#xefjlcyhds .gt_center {
  text-align: center;
}

#xefjlcyhds .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xefjlcyhds .gt_font_normal {
  font-weight: normal;
}

#xefjlcyhds .gt_font_bold {
  font-weight: bold;
}

#xefjlcyhds .gt_font_italic {
  font-style: italic;
}

#xefjlcyhds .gt_super {
  font-size: 65%;
}

#xefjlcyhds .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xefjlcyhds .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xefjlcyhds .gt_indent_1 {
  text-indent: 5px;
}

#xefjlcyhds .gt_indent_2 {
  text-indent: 10px;
}

#xefjlcyhds .gt_indent_3 {
  text-indent: 15px;
}

#xefjlcyhds .gt_indent_4 {
  text-indent: 20px;
}

#xefjlcyhds .gt_indent_5 {
  text-indent: 25px;
}

#xefjlcyhds .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xefjlcyhds div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Obs" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Obs</th>
<th id="A1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A1</th>
<th id="A2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A2</th>
<th id="A3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A3</th>
<th id="A4" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A4</th>
<th id="A5" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A5</th>
<th id="A6" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A6</th>
<th id="A7" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A7</th>
<th id="A8" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">A8</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Obs"></td>
<td class="gt_row gt_right" headers="A1">19</td>
<td class="gt_row gt_right" headers="A2">29</td>
<td class="gt_row gt_right" headers="A3">10</td>
<td class="gt_row gt_right" headers="A4">19</td>
<td class="gt_row gt_right" headers="A5">42</td>
<td class="gt_row gt_right" headers="A6">29</td>
<td class="gt_row gt_right" headers="A7">28</td>
<td class="gt_row gt_right" headers="A8">43</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Obs"></td>
<td class="gt_row gt_right" headers="A1">29</td>
<td class="gt_row gt_right" headers="A2">43</td>
<td class="gt_row gt_right" headers="A3">14</td>
<td class="gt_row gt_right" headers="A4">41</td>
<td class="gt_row gt_right" headers="A5">29</td>
<td class="gt_row gt_right" headers="A6">10</td>
<td class="gt_row gt_right" headers="A7">42</td>
<td class="gt_row gt_right" headers="A8">28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Obs"></td>
<td class="gt_row gt_right" headers="A1">10</td>
<td class="gt_row gt_right" headers="A2">28</td>
<td class="gt_row gt_right" headers="A3">42</td>
<td class="gt_row gt_right" headers="A4">43</td>
<td class="gt_row gt_right" headers="A5">41</td>
<td class="gt_row gt_right" headers="A6">27</td>
<td class="gt_row gt_right" headers="A7">10</td>
<td class="gt_row gt_right" headers="A8">42</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Obs"></td>
<td class="gt_row gt_right" headers="A1">42</td>
<td class="gt_row gt_right" headers="A2">3</td>
<td class="gt_row gt_right" headers="A3">28</td>
<td class="gt_row gt_right" headers="A4">28</td>
<td class="gt_row gt_right" headers="A5">14</td>
<td class="gt_row gt_right" headers="A6">42</td>
<td class="gt_row gt_right" headers="A7">43</td>
<td class="gt_row gt_right" headers="A8">27</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Obs"></td>
<td class="gt_row gt_right" headers="A1">43</td>
<td class="gt_row gt_right" headers="A2">27</td>
<td class="gt_row gt_right" headers="A3">29</td>
<td class="gt_row gt_right" headers="A4">3</td>
<td class="gt_row gt_right" headers="A5">28</td>
<td class="gt_row gt_right" headers="A6">43</td>
<td class="gt_row gt_right" headers="A7">27</td>
<td class="gt_row gt_right" headers="A8">19</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Obs" style="background-color: #ADD8E6">Médias</td>
<td class="gt_row gt_right" headers="A1" style="background-color: #ADD8E6">28.6</td>
<td class="gt_row gt_right" headers="A2" style="background-color: #ADD8E6">26</td>
<td class="gt_row gt_right" headers="A3" style="background-color: #ADD8E6">24.6</td>
<td class="gt_row gt_right" headers="A4" style="background-color: #ADD8E6">26.8</td>
<td class="gt_row gt_right" headers="A5" style="background-color: #ADD8E6">30.8</td>
<td class="gt_row gt_right" headers="A6" style="background-color: #ADD8E6">30.2</td>
<td class="gt_row gt_right" headers="A7" style="background-color: #ADD8E6">30</td>
<td class="gt_row gt_right" headers="A8" style="background-color: #ADD8E6">31.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>Cada coluna desta matriz corresponde a uma possível amostra aleatória e suas respectivas médias.</p>
<p>Algumas amostras tiveram médias muito distantes de <span class="math inline">\(\mu\)</span>, como: <span class="math inline">\(\overline{X_{A8}} = 31.8\)</span> ou <span class="math inline">\(\overline{X_{A3}} = 24.6\)</span>. Esta variação é natural do processo amostral. Os métodos de amostragem e de inferência estatística tratam justamente de como interpretar e como lidar com esta variação. Para entender melhor este processo, vamos obter <strong>todas</strong> as 252 combinações possíveis de amostras com <span class="math inline">\(n = 5\)</span> e, em seguida, extrair suas respectivas médias.</p>
<p>Os resultados das 252 médias possíveis podem ser vistos a seguir ordenados da menor para a maior média possível:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Allcomb <span class="ot">=</span> <span class="fu">combn</span>(<span class="at">x =</span> pop, <span class="at">m =</span> <span class="dv">5</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>M_Allcomb <span class="ot">=</span> <span class="fu">apply</span>(Allcomb,<span class="dv">2</span>,mean)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>M_Allcomb_round <span class="ot">=</span> <span class="fu">round</span>(M_Allcomb,<span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(M_Allcomb_round,<span class="at">nc =</span> <span class="dv">14</span>, <span class="at">byrow =</span> T))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">14.6</td>
<td style="text-align: right;">14.8</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">17.8</td>
<td style="text-align: right;">16.4</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">19.0</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">19.4</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">19.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">19.6</td>
<td style="text-align: right;">19.4</td>
<td style="text-align: right;">19.6</td>
<td style="text-align: right;">19.8</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">20.2</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">17.8</td>
<td style="text-align: right;">20.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">20.8</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">23.2</td>
<td style="text-align: right;">23.4</td>
<td style="text-align: right;">19.4</td>
<td style="text-align: right;">21.8</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: right;">22.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">24.8</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">24.8</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">27.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18.2</td>
<td style="text-align: right;">18.4</td>
<td style="text-align: right;">20.8</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">21.2</td>
<td style="text-align: right;">18.6</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">21.2</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">21.2</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">21.6</td>
<td style="text-align: right;">23.8</td>
<td style="text-align: right;">24.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">20.2</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">23.2</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">23.2</td>
<td style="text-align: right;">23.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">26.2</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">21.2</td>
<td style="text-align: right;">23.6</td>
<td style="text-align: right;">23.8</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">23.8</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">24.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">26.6</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">26.6</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">29.6</td>
<td style="text-align: right;">25.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">28.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">28.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">28.8</td>
<td style="text-align: right;">31.2</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">28.8</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">31.4</td>
<td style="text-align: right;">31.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">19.6</td>
<td style="text-align: right;">19.8</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">25.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">21.6</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">24.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">27.6</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">25.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27.8</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">28.4</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">28.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">31.0</td>
<td style="text-align: right;">27.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">29.6</td>
<td style="text-align: right;">29.8</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">29.8</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">30.2</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">30.2</td>
<td style="text-align: right;">30.4</td>
<td style="text-align: right;">32.8</td>
<td style="text-align: right;">33.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23.4</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">26.2</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">26.2</td>
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">28.8</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">26.2</td>
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">26.6</td>
<td style="text-align: right;">28.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">29.2</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">29.2</td>
<td style="text-align: right;">29.4</td>
<td style="text-align: right;">31.8</td>
<td style="text-align: right;">27.8</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">30.4</td>
<td style="text-align: right;">30.6</td>
<td style="text-align: right;">30.8</td>
<td style="text-align: right;">30.6</td>
<td style="text-align: right;">30.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31.0</td>
<td style="text-align: right;">33.4</td>
<td style="text-align: right;">30.8</td>
<td style="text-align: right;">31.0</td>
<td style="text-align: right;">31.2</td>
<td style="text-align: right;">33.6</td>
<td style="text-align: right;">33.8</td>
<td style="text-align: right;">28.8</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">29.2</td>
<td style="text-align: right;">31.4</td>
<td style="text-align: right;">31.6</td>
<td style="text-align: right;">31.8</td>
<td style="text-align: right;">31.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">31.8</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: right;">34.4</td>
<td style="text-align: right;">31.8</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: right;">32.2</td>
<td style="text-align: right;">34.6</td>
<td style="text-align: right;">34.8</td>
<td style="text-align: right;">33.4</td>
<td style="text-align: right;">33.6</td>
<td style="text-align: right;">33.8</td>
<td style="text-align: right;">36.2</td>
<td style="text-align: right;">36.4</td>
<td style="text-align: right;">36.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A menor e maior médias possíveis são 14.6 e 36.6 respectivamente. Estes valores são os mais distantes do parâmetro populacional (<span class="math inline">\(\mu = 25.6\)</span>) e ocorrem <strong>puramente ao acaso</strong> quanto são amostrados os 5 menores (3, 10, 14, 19, 27) ou os 5 maiores (43, 42, 41, 29, 28) elementos da população estatística. Estes casos extremos são <strong>raros</strong>. Em nosso exemplo, valores superiores a 33.8 ou inferiores a 17.4 são muito improváveis.</p>
<p>Podemos avaliar graficamente a distribuição das médias amostrais através de um histograma. A grande maioria das médias amostrais concentra-se na porção intermediária do gráfico entre estes limites. Por exemplo, somente 3.2% das observações estão acima de 33.8. Da mesma forma, somente 3.2% das observações estão abaixo de 17.4</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>M_Allcomb_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">M =</span> <span class="fu">as.numeric</span>(M_Allcomb))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>gp5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(M_Allcomb_df, <span class="fu">aes</span>(<span class="at">x =</span> M)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">'brown3'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Médias"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>gp5</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-medias252" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-medias252-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tipos-amostragem_files/figure-html/fig-hist-medias252-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-medias252-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Histograma das 252 médias amostrais obtidas a partis de amostras de tamanho n = 5.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Se calcularmos a <strong>média das médias</strong> (<span class="math inline">\(\mu_{\overline{X}}\)</span>), ou seja, somarmos todos estes valores e dividirmos por 252, o resultado será 25.6, que é exatamente o valor da média populacional <span class="math inline">\(\mu\)</span>. Isto têm uma implicação central em inferência estatística. Significa que a média amostral <span class="math inline">\(\overline{X}\)</span> é um estimador <strong>acurado</strong> (= <strong>não-viciado</strong>), pois tende a estimar corretamente o valor da média populacional <span class="math inline">\(\mu\)</span>. Ou seja, o histograma acima está centrado ao redor de <span class="math inline">\(\mu\)</span>, o que significa que <strong>em média</strong> uma amostra particular tem maior probabilidade de expressar um <span class="math inline">\(\overline{X}\)</span> próximo ao valor populacional.</p>
</section>
<section id="precisão-o-erro-padrão-da-média-sigma_overlinex" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="precisão-o-erro-padrão-da-média-sigma_overlinex"><span class="header-section-number">4.3</span> Precisão: o erro padrão da média (<span class="math inline">\(\sigma_{\overline{X}}\)</span>)</h3>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Allcomb7 <span class="ot">=</span> <span class="fu">combn</span>(<span class="at">x =</span> pop, <span class="at">m =</span> n2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>M_Allcomb7 <span class="ot">=</span> <span class="fu">apply</span>(Allcomb7,<span class="dv">2</span>,mean)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>M_Allcomb7_round <span class="ot">=</span> <span class="fu">round</span>(M_Allcomb7,<span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>CT2 <span class="ot">=</span> <span class="fu">choose</span>(N,n2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Suponha agora que tomemos ao acaso amostras com <span class="math inline">\(n = 7\)</span> desta mesma população. Existem ao todo:</p>
<p><span class="math display">\[{{10}\choose{7}} = \frac{10!}{(10-7)! \times 7!} = 120\]</span></p>
<p>amostras diferentes de tamanho <span class="math inline">\(n = 7\)</span> que podem ser retiradas de uma população de tamanho <span class="math inline">\(n = 10\)</span>. Se tomarmos estas 120 amostras e calcularmos suas respectivas médias amostrais, teremos os resultados abaixo:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(M_Allcomb7_round,<span class="at">nc =</span> <span class="dv">12</span>, <span class="at">byrow =</span> T))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">18.6</td>
<td style="text-align: right;">20.3</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">20.7</td>
<td style="text-align: right;">22.3</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">20.7</td>
</tr>
<tr class="even">
<td style="text-align: right;">20.9</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">21.7</td>
<td style="text-align: right;">21.9</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: right;">23.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">23.9</td>
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">23.9</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">25.7</td>
<td style="text-align: right;">23.9</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right;">25.9</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">22.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">24.3</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">24.7</td>
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">24.7</td>
<td style="text-align: right;">24.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26.6</td>
<td style="text-align: right;">26.7</td>
<td style="text-align: right;">25.7</td>
<td style="text-align: right;">25.9</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">27.7</td>
<td style="text-align: right;">27.9</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">23.1</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">24.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">25.1</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">25.1</td>
<td style="text-align: right;">25.3</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">25.1</td>
<td style="text-align: right;">25.3</td>
<td style="text-align: right;">25.4</td>
<td style="text-align: right;">27.1</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">26.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">26.6</td>
<td style="text-align: right;">28.3</td>
<td style="text-align: right;">28.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">27.1</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">29.1</td>
<td style="text-align: right;">29.3</td>
<td style="text-align: right;">30.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right;">24.3</td>
<td style="text-align: right;">25.9</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">26.1</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">26.1</td>
<td style="text-align: right;">26.3</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">26.1</td>
<td style="text-align: right;">26.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26.4</td>
<td style="text-align: right;">28.1</td>
<td style="text-align: right;">28.3</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">27.6</td>
<td style="text-align: right;">29.3</td>
<td style="text-align: right;">29.4</td>
<td style="text-align: right;">29.6</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">28.1</td>
<td style="text-align: right;">28.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">30.1</td>
<td style="text-align: right;">30.3</td>
<td style="text-align: right;">31.4</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">28.7</td>
<td style="text-align: right;">28.9</td>
<td style="text-align: right;">30.6</td>
<td style="text-align: right;">30.7</td>
<td style="text-align: right;">30.9</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: right;">32.7</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>M_Allcomb7_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">M =</span> <span class="fu">as.numeric</span>(M_Allcomb7))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>gp7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(M_Allcomb7_df, <span class="fu">aes</span>(<span class="at">x =</span> M)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">'brown3'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Média"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>gp7</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-medias120" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-medias120-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tipos-amostragem_files/figure-html/fig-hist-medias120-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-medias120-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3: Histograma das 120 médias amostrais obtidas a partis de amostras de tamanho n = 7
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mu_pop <span class="ot">=</span> <span class="fu">mean</span>(pop)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(pop)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>var_pop <span class="ot">=</span> <span class="fu">mean</span>((pop <span class="sc">-</span> mu_pop)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sigma_pop <span class="ot">=</span> <span class="fu">sqrt</span>(var_pop)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ep5 <span class="ot">=</span> sigma_pop<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>ep7 <span class="ot">=</span> sigma_pop<span class="sc">/</span><span class="fu">sqrt</span>(n2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Se compararmos os histogramas com <span class="math inline">\(n = 5\)</span> e <span class="math inline">\(n = 7\)</span> (<a href="#fig-hist-medias252" class="quarto-xref">Figura&nbsp;2</a> e <a href="#fig-hist-medias120" class="quarto-xref">Figura&nbsp;3</a>), veremos que os dois resultam em estimadores acurados, pois <span class="math inline">\(\mu_{\overline{X}} = \mu\)</span>. No entando, o <strong>intervalo de variação</strong> é menor para amostras de tamanho <span class="math inline">\(n = 7\)</span>. Para esta figura, os valores estão mais concentrados ao redor da média. Portanto, à medida que aumenta o tamanho amostral, diminui a dispersão das médias amostrais ao redor de <span class="math inline">\(\mu\)</span>. Assim, para amostras grandes torna-se mais <strong>improvável</strong> obter uma média amostral distante da média populacional. Dizemos então que conforme aumenta o tamanho amostral, conseguimos estimativas mais precisas.</p>
<p>A precisão de um estimador pode ser medida pelo <strong>Erro padrão da média</strong> (<span class="math inline">\(\sigma_{\overline{X}}\)</span>) que pode ser calculado por:</p>
<p><span class="math display">\[\sigma_{\overline{X}} = \frac{\sigma}{\sqrt{n}}\]</span></p>
<p>O erro padrão da média é o desvio padrão de <strong>todas</strong> as médias amostrais que poderiam ser obtidas de uma amostra com tamanho <span class="math inline">\(n\)</span>. Para nosso exemplo com <span class="math inline">\(n = 5\)</span>, <span class="math inline">\(\sigma_{\overline{X}}\)</span> = 5.93, enquanto para <span class="math inline">\(n = 7\)</span>, <span class="math inline">\(\sigma_{\overline{X}}\)</span> = 5.01. Dizemos que o último exemplo fornece estimativas <strong>mais precisas</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Erro padrão amostral
</div>
</div>
<div class="callout-body-container callout-body">
<p>Na prática científica não conhecemos o desvio padrão populacional <span class="math inline">\(\sigma\)</span> e, consequentemente, não temos obter o erro padrão populacional <span class="math inline">\(\sigma_{\overline{X}}\)</span>. No entanto, dado que temos uma amostra particular, podemos <strong>estimá-lo</strong> a partir do desvio padrão amostral <span class="math inline">\(\sigma_{\overline{X}}\)</span> pela expressão:</p>
<p><span class="math display">\[s_{\overline{X}} = \frac{s}{\sqrt{n}}\]</span></p>
<p>em que <span class="math inline">\(s_{\overline{X}}\)</span> é denominado de <strong>erro padrão amostral</strong></p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vídeo-aulas
</div>
</div>
<div class="callout-body-container callout-body">
<iframe style="width:100%; aspect-ratio:16/9;" src="https://www.youtube-nocookie.com/embed/iyzCGvlxN-o" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/FCopf\/MEAD");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>