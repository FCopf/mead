{
  "hash": "2b6fae00a903e7f225ef8bdc659cb145",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Construindo um modelo bayesiano\"  \nsubtitle: \"VerossimilhanÃ§a e distribuiÃ§Ã£o *a priori*\"  \ndescription: \"ConstruÃ§Ã£o de um modelo bayesiano, enfatizando a formulaÃ§Ã£o de distribuiÃ§Ãµes a priori e posterior. Baseado em *Statistical Rethinking* [@mcelreath2018statistical].\"\nCategories: [\n          \"InferÃªncia bayesiana\",\n          \"DistribuiÃ§Ã£o a priori\",\n          \"DistribuiÃ§Ã£o posterior\",\n          \"Modelo binomial\"\n        ]\nimage: \"images/intro-bayes-modelo-bayesiano.png\"  \nexecute:\n  echo: false\n  warning: false\n  include: true\n  message: false\n---\n\n\n\n\n---\n\nConsidere um globo representando o planeta Terra, pequeno o suficiente para caber em suas mÃ£os. Seu objetivo Ã© estimar a fraÃ§Ã£o da superfÃ­cie coberta por Ã¡gua. Para isso, vocÃª adota a seguinte estratÃ©gia: joga o globo para cima girando e, ao pegÃ¡-lo, registra se o ponto tocado pelo seu dedo indicador direito Ã© Ã¡gua (ğŸŒŠ) ou terra (ğŸœï¸). VocÃª repete esse procedimento algumas vezes, obtendo uma sequÃªncia de $n$ observaÃ§Ãµes.\n\nVocÃª faz quatro lanÃ§amentos do globo e conta quantos deles resultam em Ã¡gua. Um possÃ­vel resultado seria $ğŸŒŠğŸŒŠğŸœï¸ğŸŒŠ$, totalizando 3 observaÃ§Ãµes de Ã¡gua e 1 de terra. Outro resultado possÃ­vel Ã© $ğŸœï¸ğŸœï¸ğŸŒŠğŸŒŠ$, com 2 observaÃ§Ãµes de Ã¡gua e 2 de terra. Para $n = 4$ observaÃ§Ãµes, existem 16 resultados possÃ­veis (@tbl-proporcao-globo).\n\n| NÂº |       Dados       | NÂº pontos na Ã¡gua | ProporÃ§Ã£o de pontos na Ã¡gua |\n|:--:|:-----------------:|:-----------------:|:----------------------------:|\n|  1 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸœï¸      | 0                 | 0/4 = 0.00                   |\n|  2 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸŒŠ      | 1                 | 1/4 = 0.25                   |\n|  3 | ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸœï¸      | 1                 | 1/4 = 0.25                   |\n|  4 | ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸœï¸      | 1                 | 1/4 = 0.25                   |\n|  5 | ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸœï¸      | 1                 | 1/4 = 0.25                   |\n|  6 | ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸŒŠ      | 2                 | 2/4 = 0.50                   |\n|  7 | ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸŒŠ      | 2                 | 2/4 = 0.50                   |\n|  8 | ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸœï¸      | 2                 | 2/4 = 0.50                   |\n|  9 | ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸŒŠ      | 2                 | 2/4 = 0.50                   |\n| 10 | ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸœï¸      | 2                 | 2/4 = 0.50                   |\n| 11 | ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸœï¸      | 2                 | 2/4 = 0.50                   |\n| 12 | ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸŒŠ      | 3                 | 3/4 = 0.75                   |\n| 13 | ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸŒŠ      | 3                 | 3/4 = 0.75                   |\n| 14 | ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸŒŠ      | 3                 | 3/4 = 0.75                   |\n| 15 | ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸœï¸      | 3                 | 3/4 = 0.75                   |\n| 16 | ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸŒŠ      | 4                 | 4/4 = 1.00                   |\n\n: **Resultados possÃ­veis de 4 observaÃ§Ãµes (terra ou Ã¡gua) com o respectivo nÃºmero e proporÃ§Ã£o de observaÃ§Ãµes em Ã¡gua.** {#tbl-proporcao-globo .striped .hover}\n\nObserve que apenas um dos resultados contÃ©m 4 observaÃ§Ãµes de terra e somente um contÃ©m 4 observaÃ§Ãµes de Ã¡gua. Os demais sÃ£o variaÃ§Ãµes entre esses extremos.\n\nPodemos reorganizar a tabela para evidenciar todas as combinaÃ§Ãµes que levam ao mesmo nÃºmero $y_i$ de pontos em Ã¡gua:\n\n| NÂº pontos na Ã¡gua ($y_i$) | Dados | NÂº de combinaÃ§Ãµes |\n|:---------------------------:|:------|:-----------------|\n| 0 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸœï¸ | 1 |\n| 1 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸœï¸ <br> ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸœï¸ | 4 |\n| 2 | ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸŒŠ <br> ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸœï¸ | 6 |\n| 3 | ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸŒŠ <br> ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸŒŠ <br> ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸŒŠ <br> ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸœï¸ | 4 |\n| 4 | ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸŒŠ | 1 |\n\n: **CombinaÃ§Ãµes que resultam em $y_i$ pontos na Ã¡gua.** {#tbl-combinacao-globo tbl-colwidths=\"[25,50,25]\" .striped .hover}\n\n<br>\n\nDefina $p$ como a probabilidade de observar Ã¡gua e $1 - p$ como a probabilidade de observar terra apÃ³s cada lanÃ§amento do globo.\n\nA Ãºltima linha da @tbl-combinacao-globo (ğŸŒŠğŸŒŠğŸŒŠğŸŒŠ) tem probabilidade:\n$$P(4) = p \\times p \\times p \\times p.$$\n\nEnquanto a primeira linha (ğŸœï¸ğŸœï¸ğŸœï¸ğŸœï¸) ocorre com probabilidade:\n$$P(0) = (1 - p) \\times (1 - p) \\times (1 - p) \\times (1 - p).$$\n\nAs linhas correspondentes a $P(1)$, $P(2)$ e $P(3)$ sÃ£o combinaÃ§Ãµes de $p$ e $(1 - p)$, multiplicadas pelo nÃºmero de formas pelas quais 1, 2 ou 3 registros de Ã¡gua podem ocorrer em 4 lanÃ§amentos.\n\n<br>\n\n| NÂº pontos na Ã¡gua ($y$) | Dados | NÂº de combinaÃ§Ãµes | $P(Y)$ |\n|:---------------------------:|:------|:-----------------:|:--------|\n| 0 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸœï¸ | 1 | $1 \\times (1-p) \\times (1-p) \\times (1-p) \\times (1-p)$ |\n| 1 | ğŸœï¸ ğŸœï¸ ğŸœï¸ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸœï¸ <br> ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸœï¸ | 4 | $4 \\times p \\times (1-p) \\times (1-p) \\times (1-p)$ |\n| 2 | ğŸœï¸ ğŸœï¸ ğŸŒŠ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸœï¸ ğŸŒŠ <br> ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸœï¸ ğŸœï¸ ğŸŒŠ <br> ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸœï¸ <br> ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸœï¸ | 6 | $6 \\times p \\times p \\times (1-p) \\times (1-p)$ |\n| 3 | ğŸœï¸ ğŸŒŠ ğŸŒŠ ğŸŒŠ <br> ğŸŒŠ ğŸœï¸ ğŸŒŠ ğŸŒŠ <br> ğŸŒŠ ğŸŒŠ ğŸœï¸ ğŸŒŠ <br> ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸœï¸ | 4 | $4 \\times p \\times p \\times p  \\times (1-p)$ |\n| 4 | ğŸŒŠ ğŸŒŠ ğŸŒŠ ğŸŒŠ | 1 | $1 \\times p \\times p \\times p \\times p$ |\n\n: **Probabilidade $P(Y)$ de observar diferentes nÃºmeros ($y$) de pontos sobre a Ã¡gua.** {#tbl-probabilidade-globo tbl-colwidths=\"[25,30,15,30]\" .striped .hover}\n\n<br>\n\n## O modelo Binomial\n\nA partir das expressÃµes para $P(y)$ apresentadas na @tbl-probabilidade-globo, obtÃ©m-se uma fÃ³rmula geral que pode ser escrita como:\n\n$$P(y \\mid n, p) = \\binom{n}{y} \\, p^y (1 - p)^{n - y}.\n$${#eq-binomial}\n\n**Onde:**\n\n- $y \\in \\{0, 1, 2, \\dots, n\\}$ Ã© o nÃºmero de observaÃ§Ãµes de ğŸŒŠ;\n- $n$ Ã© o nÃºmero total de observaÃ§Ãµes;\n- $p$ Ã© a fraÃ§Ã£o de ğŸŒŠ que cobre o globo;\n- $\\binom{n}{y}$ Ã© o coeficiente binomial, calculado por $\\frac{n!}{y!(n - y)!}$, indicando de quantas maneiras a combinaÃ§Ã£o $p^y (1 - p)^{n - y}$ pode ocorrer.\n\nA @eq-binomial fornece a probabilidade de cada resultado possÃ­vel (nÃºmero de observaÃ§Ãµes ğŸŒŠ) em $n$ tentativas, permitindo calcular a probabilidade de **todos** os possÃ­veis resultados do experimento.\n\n## VerossimilhanÃ§a: a plausibilidade de uma hipÃ³tese\n\n\n\nA partir do modelo binomial, podemos definir a **funÃ§Ã£o de verossimilhanÃ§a** para um resultado observado. Imagine que, em $n = 4$ lanÃ§amentos, foram observados $y = 2$ pontos sobre a Ã¡gua. NÃ£o sabemos a verdadeira proporÃ§Ã£o $p$ de Ã¡gua que cobre a Terra; portanto, fazemos conjecturas e avaliamos cada uma com base nas observaÃ§Ãµes.\n\nPor exemplo, se supormos que a proporÃ§Ã£o verdadeira seja 40% $(p = 0.4)$, a distribuiÃ§Ã£o binomial determina que a probabilidade de observar $y = 2$ sucessos em $n = 4$ lanÃ§amentos seja:\n\n$$P(y = 2 \\mid n = 4, p = 0.4) = \\binom{4}{2} \\, 0.4^2 (1 - 0.4)^{4 - 2} = 0.35$$\n\nEssa hipÃ³tese Ã© apenas uma das possÃ­veis. Para ilustrar outras conjecturas, considere:\n\n- Se $p = 0.3$:\n\n  $P(2 \\mid 4, 0.3) = \\binom{4}{2} \\, 0.3^2 (1 - 0.3)^{4 - 2} = 0.26$\n\n- Se $p = 0.8$:\n\n  $P(2 \\mid 4, 0.8) = \\binom{4}{2} \\, 0.8^2 (1 - 0.8)^{4 - 2} = 0.15$\n\nEm cada caso, os dados observados $(y)$ e o nÃºmero total de observaÃ§Ãµes $(n)$ estÃ£o fixos, enquanto o parÃ¢metro $p$ varia conforme a hipÃ³tese considerada. Embora a forma matemÃ¡tica seja idÃªntica Ã  da funÃ§Ã£o de probabilidade binomial, seu uso Ã© diferente. Na funÃ§Ã£o de probabilidade, lemos a *probabilidade de $y$ dado $n$ e $p$*, enquanto nos exemplos acima, avaliamos a **plausibilidade de diferentes hipÃ³teses sobre $p$ dados valores fixos de $y$ e $n$**. \n\nPara evitar confusÃµes, vamos definir a funÃ§Ã£o de verossimilhanÃ§a como:\n\n$$\n\\mathcal{L}(p \\mid n, y) = \\binom{n}{y} \\, p^y (1 - p)^{n - y}.\n$$ {#eq-likelihood-binomial}\n\nAssim, as verossimilhanÃ§as para as trÃªs conjecturas especÃ­ficas sobre a proporÃ§Ã£o de Ã¡gua na superfÃ­cie do globo serÃ£o:\n\n- $\\mathcal{L}(p = 0.4 \\mid n = 4, y = 2) = 0.35$,\n- $\\mathcal{L}(p = 0.3 \\mid n = 4, y = 2) = 0.26$,\n- $\\mathcal{L}(p = 0.8 \\mid n = 4, y = 2) = 0.15$.\n\nDessa forma, entre as trÃªs hipÃ³teses levantadas, aquela em que $p = 0.4$ recebe **maior suporte das evidÃªncias**, por estar associada Ã  maior verossimilhanÃ§a.\n\nPodemos quantificar esse suporte por meio da **razÃ£o de verossimilhanÃ§as**:\n\n$$RV = \\frac{\\mathcal{L}(p = 0.4 \\mid 4, 2)}{\\mathcal{L}(p = 0.3 \\mid 4, 2)} = \\frac{0.35}{0.26} = 1.35,$$\n\no que indica que, com base nos dados observados, a hipÃ³tese de $p = 0.4$ Ã© aproximadamente $1.35$ **vezes mais verossÃ­mil** do que a hipÃ³tese de $p = 0.3$.\n\n::: {.callout-warning title=\"Resumo: A FunÃ§Ã£o de VerossimilhanÃ§a Binomial\"}\n\n- A expressÃ£o Ã© **matematicamente idÃªntica** Ã  funÃ§Ã£o de probabilidade binomial, porÃ©m interpretada como uma funÃ§Ã£o de $p$ quando os dados $Y$ e $n$ sÃ£o fixos.\n- A verossimilhanÃ§a indica a plausibilidade de diferentes valores de $p$ Ã  luz dos dados observados.\n- Na distribuiÃ§Ã£o binomial, lemos: **probabilidade de $Y$ dado $n$ e $p$**.\n- Na funÃ§Ã£o de verossimilhanÃ§a, interpretamos: **verossimilhanÃ§a de $p$ dado $n$ e $Y$**.\n- A razÃ£o de verossimilhanÃ§as pode ser utilizada para quantificar o suporte relativo entre diferentes hipÃ³teses.\n:::\n\n### O perfil de verossimilhanÃ§a\n\nAcima, foram testadas trÃªs conjecturas especÃ­ficas para a proporÃ§Ã£o de Ã¡gua na superfÃ­cie da Terra ($p = 0.3$, $p = 0.4$, $p = 0.8$). Para uma avaliaÃ§Ã£o mais completa, podemos analisar o **perfil de verossimilhanÃ§a** para uma sÃ©rie de valores de $p$ entre 0 e 1:\n\n::: {#3d38f8be .cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n![](intro-bayes-modelo-bayesiano_files/figure-html/cell-3-output-1.png){width=597 height=451}\n:::\n:::\n\n\nO perfil de verossimilhanÃ§a indica que, Ã  luz dos nossos dados $y = 2$, a conjectura mais plausÃ­vel Ã© que a proporÃ§Ã£o de Ã¡gua que cobre a Terra esteja prÃ³xima de 0.5 (neste caso, a verossimilhanÃ§a mÃ¡xima Ã© *exatamente* para $p = 0.5$).\n\n## InferÃªncia Bayesiana: distribuiÃ§Ãµes *a priori* e *a posteriori*\n\nA inferÃªncia bayesiana utiliza o **Teorema de Bayes** para derivar a distribuiÃ§Ã£o *a posteriori* dos parÃ¢metros de interesse, $p(\\theta \\mid Y)$, a partir da verossimilhanÃ§a $p(Y \\mid \\theta)$ e da distribuiÃ§Ã£o *a priori* $p(\\theta)$:\n\n$$p(\\theta \\mid Y) = \\frac{p(Y \\mid \\theta) \\times p(\\theta)}{p(Y)}$$ {#eq-bayes}\n\nEm que:\n\n- **$p(\\theta \\mid Y)$**: distribuiÃ§Ã£o *a posteriori* de $\\theta$ dado os dados observados $Y$;\n- **$p(Y \\mid \\theta)$**: verossimilhanÃ§a dos dados $Y$ dada $\\theta$;\n- **$p(\\theta)$**: distribuiÃ§Ã£o *a priori* de $\\theta$;\n- **$p(Y)$**: probabilidade marginal dos dados, obtida por\n\n$$\\int p(Y \\mid \\theta) \\times p(\\theta) \\, d\\theta$$\n\nNo contexto bayesiano, Ã© comum substituir $p(Y \\mid \\theta)$ pela **funÃ§Ã£o de verossimilhanÃ§a** $\\mathcal{L}(\\theta \\mid Y)$, pois ambas sÃ£o matematicamente equivalentes. Assim, a fÃ³rmula da distribuiÃ§Ã£o *a posteriori* pode ser reescrita como:\n\n$$p(\\theta \\mid Y) = \\frac{\\mathcal{L}(\\theta \\mid Y) \\times p(\\theta)}{p(Y)}$$ {#eq-bayes-likelihood}\n\n## Priori informativa e nÃ£o informativa\n\nDenominamos *priori* **nÃ£o informativa** aquela que nÃ£o acrescenta informaÃ§Ãµes relevantes Ã  distribuiÃ§Ã£o *a posteriori* alÃ©m daquelas jÃ¡ contidas nos dados observados. Nesses casos, a distribuiÃ§Ã£o *a posteriori* Ã© proporcional apenas Ã  **verossimilhanÃ§a**:\n\n$$p(\\theta \\mid Y) \\propto \\mathcal{L}(\\theta \\mid Y)$$  {#eq-prop-posteriori-uniforme}\n\nPor outro lado, ao adotarmos uma *priori* **informativa**, atribuÃ­mos diferentes densidades de probabilidade Ã s regiÃµes especÃ­ficas do espaÃ§o de parÃ¢metros, refletindo o conhecimento prÃ©vio sobre o fenÃ´meno estudado. A distribuiÃ§Ã£o *a posteriori*, nesse caso, serÃ¡ proporcional ao produto entre a verossimilhanÃ§a e a *priori*, integrando evidÃªncias anteriores com a informaÃ§Ã£o contida nos dados:\n\n$$p(\\theta \\mid Y) \\propto \\mathcal{L}(\\theta \\mid Y) \\times p(\\theta)$$  {#eq-prop-posteriori-likelihood}\n\nNo modelo binomial aplicado Ã  proporÃ§Ã£o de Ã¡gua na superfÃ­cie oceÃ¢nica, o parÃ¢metro $\\theta$ representa a proporÃ§Ã£o de Ã¡gua $p$, e sua distribuiÃ§Ã£o posterior Ã© condicional ao nÃºmero de observaÃ§Ãµes $n$ e aos dados observados $y$.\n\nA distribuiÃ§Ã£o *a priori* para $p$ pode ser **nÃ£o informativa**, como no caso da distribuiÃ§Ã£o uniforme, que nÃ£o favorece nenhum valor especÃ­fico de $p$. Alternativamente, pode-se adotar uma *priori* **informativa**, como a distribuiÃ§Ã£o Beta, que permite ajustar a forma da densidade de probabilidade por meio dos parÃ¢metros $\\alpha$ e $\\beta$, incorporando conhecimento prÃ©vio sobre o fenÃ´meno de interesse.\n\nPara ilustrar o efeito de *prioris* informativas e nÃ£o-informativas sobre a distribuiÃ§Ã£o a posteriori, siga a atividade abaixo:\n\n::: {.callout-tip title=\"Atividades interativas: estimando a proporÃ§Ã£o da superfÃ­cie oceÃ¢nica!\"}\n\n1. **Amostre pontos no globo e faÃ§a sua prÃ³pria inferÃªncia bayesiana**  \n   No app abaixo, gere **pontos aleatÃ³rios** na superfÃ­cie da Terra e verifique quantos caem em Ã¡gua ou em terra.  \n   \n   ğŸ‘‰ [**Estimando a ProporÃ§Ã£o da SuperfÃ­cie OceÃ¢nica**](https://fcopf-dash-ocean-surface.share.connect.posit.cloud/){target=_blank}\n   \n   - Escolha quantos pontos deseja amostrar (1 a 1000).  \n   - Clique em â€œGerar Pontos AleatÃ³riosâ€ e observe quantos ficam sobre a Ã¡gua versus sobre a terra.  \n   - Registre esses valores como $k$ sucessos em $N$ pontos (N observaÃ§Ãµes).\n\n2. **Utilize seus dados na inferÃªncia Bayesiana**  \n   Em seguida, abra o app abaixo para visualizar como as observaÃ§Ãµes (sucessos e fracassos) combinadas a diferentes escolhas de parÃ¢metros *a priori* ($\\alpha$, $\\beta$) geram a distribuiÃ§Ã£o *a posteriori*:  \n   \n   ğŸ‘‰ [**InferÃªncia Bayesiana**](https://fcopf-binomial-bayesiana.share.connect.posit.cloud/){target=_blank}\n\n   **Dicas de uso**  \n   - Insira o mesmo **nÃºmero de observaÃ§Ãµes (N)** e **sucessos (k)** obtidos no primeiro app.  \n   - Ajuste interativamente a distribuiÃ§Ã£o *a priori* Beta, modificando os parÃ¢metros $\\alpha$ e $\\beta$.\n   - Observe como a curva azul (â€œposterioriâ€) se altera de acordo com a *a priori* e com os dados observados, e compare com o perfil de verossimilhanÃ§a (curva verde).\n   - Note que ao escolher $\\alpha = 1$ e $\\beta = 1$ a distribuiÃ§Ã£o assume um formato uniforme, tornando-se nÃ£o-informativa.\n\n:::\n\n",
    "supporting": [
      "intro-bayes-modelo-bayesiano_files"
    ],
    "filters": [],
    "includes": {}
  }
}