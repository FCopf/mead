{
  "hash": "cd4d4504287867f2a5511de754af0bf6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"O modelo de distribuição normal\"\ndescription: \"Introdução à distribuição normal, suas características e aplicações no contexto da inferência estatística.\"\nCategories: [\n          \"Estatística\",\n          \"Inferência estatística\",\n          \"Distribuição normal\"\n        ]\n\nimage: \"images/distr-norm.jpg\"\nexecute:\n  echo: true\n  warning: false\n  include: true\n  message: false\n---\n\n\n\n\n:::{.callout-tip collapse=\"true\"}\n## Pacotes e funções utilizados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\nsource('scripts/normal-empirica-gg.r')\n```\n:::\n\n\n\n\n:::\n\nTécnicas de estatística descritiva nos permitem entender os padrões resultantes de fenômenos que já aconteceram, enquanto a inferência estatística nos fornece elementos para fazer predições sobre o que **poderá acontecer**. A predição se torna possível pelo uso de **modelos probabilísticos**, entre os quais está a distribuição normal de probabilidades.\n\nModelos probabilísticos são definidos por **funções de probabilidade** e as variáveis descritas por estes modelos são denominadas de **variáveis aleatórias**. Uma variável aleatória resulta de um **experimento aleatório** como i) medir a altura de uma pessoa; ii) tomar a temperatura em uma cidade; ii) medir a taxa de crescimento de uma bactéria; etc. A questão relevante nestes experimentos é que *antes* de serem realizados, não temos certeza sobre qual serão seus resultados. \n\nEmbora não saibamos quais serão os resultados de um experimento aleatório com exatidão, podemos nos basear em algum modelo probabilidades para prever a chance de um resultado observado estar dentro de determinados limites. Neste sentido, o papel de um modelo probabilístico é, **delimitar a incerteza** ao redor dos resultados possíveis de um experimento aleatório.\n\nAo medir a altura de uma pessoa podemos supor que, possivelmente, o resultado ficará abaixo de $1,9$ m. Supomos isto pois temos conhecimento de que a altura de maior parte das pessoas está abaixo deste limite. Se quisermos atribuir um valor de probabilidade a esta suposição devemos:\n\n  1. Assumir que a variável altura segue um determinado modelo de probabilidades, e\n  \n  2. Utilizar dados de um experimento para estimar os parâmetros deste modelo a fim de calcularmos a probabilidade $P(X \\le 1,9)$.\n\n\nNeste capítulo  iremos discutir pela primeira vez o modelo de distribuição normal e aprenderemos como encontrar estas probabilidades. \n\nImporte a base de dados `altura2022.csv`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nie = read_delim(\"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/altura2022.csv\")\n```\n:::\n\n\n\n\n\nA **distribuição normal de probabilidades** descreve uma curva em forma de sino também chamada de **distribuição gaussiana**. Um dos motivos que a tornaram central em estatística foi a percepção de que o comportamento de muitos fenômenos naturais podem ser descritos adequadamente por este modelo teórico. Veja por exemplo, o histograma de *alturas* de $110$ estudantes de uma turma de Introdução a Estatística do curso de Bacharelado Interdisciplinar em Ciências do Mar (UNIFESP). A linha vermelha sobre este histograma representa a distribuição normal teórica. À direita desta figura está um histograma da *temperatura média anual* em uma cidade americana, onde também foi sobreposta uma curva normal teórica. Embora estes dados descrevam fenômenos completamente distintos, a distribuição normal se adequa razoavelmente bem aos dois histogramas.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Altura (m) de alunos de um curso de estatística e temperatura média anual de uma cidade americana.](distr-norm_files/figure-html/fig-exemplos-norm-1.png){#fig-exemplos-norm width=768}\n:::\n:::\n\n\n\n\nO segundo motivo que torna a distribuição normal uma das mais importantes em estatística será nosso tema de estudo neste e nos próximos capítulos, pois a distribuição normal surge como o modelo esperado para a distribuição das médias amostrais sob determinadas condições, o que nos permite utilizar uma variedade de procedimentos analíticos no campo da inferência e testes de hipótese.\n\n## O modelo normal de probabilidades\n\nO modelo normal de probabilidades é uma função matemática dada por:\n\n$$f(x) = \\frac{1}{\\sqrt(2\\pi\\sigma^2)}e^{-\\frac{1}{2}(\\frac{x-\\mu}{\\sigma})^2}, x \\in \\mathbb{R} | -\\infty \\le y \\le +\\infty$$\n\nA expressão envolve as quantias $\\mu$ e $\\sigma$, definidas como os **parâmetros** da distribuição que representam respectivamente, sua média e o desvio padrão. Para dizer que uma variável aleatória $X$ tem distribuição normal por meio da expressão:\n\n$X \\sim \\mathcal{N}(\\mu,\\,\\sigma)$\n\nEsta expressão diz de $X$ é normalmente distribuída ($\\mathcal{N}$) e que esta distribuição tem parâmetros $\\mu$ e $\\sigma$.\n\nA média de uma distribuição normal é o ponto central da curva e o desvio padrão mede o espalhamento das observações ao redor de $\\mu$. Em um fenômeno descrito por valores baixos de $\\sigma$, a maioria das observações estará próxima a $\\mu$, enquanto para valores altos de $\\sigma$ as observações estarão mais distantes de $\\mu$. Deste modo, podemos alterar o formato da distribuição normal alterando seu parâmetro de posição (i.e. a média $\\mu$) e de dispersão (i.e. o desvio padrão $\\sigma$).\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Distribuições normais de probabilidade para diferentes combinações de média e desvio padrão.](distr-norm_files/figure-html/fig-norm-descricao-1.png){#fig-norm-descricao width=1152}\n:::\n:::\n\n\n\n\n\nSe as observações sobre um determinado fenômeno sugerem um padrão em forma de sino, podemos buscar a melhor combinação de $\\mu$ e $\\sigma$ e descrever o fenômeno por meio de um modelo normal. Ao fazer isto, a distribuição normal nos ajuda a calcular as probabilidade da ocorrência de eventos futuros estarem em diferentes faixas de valores. No caso das alturas dos alunos por exemplo, vemos que a probabilidade de um aluno ter mais de $2$ metros ou menos de $1,5$ metros é extremamente baixa. Assumindo um modelo de distribuição normal para a distribuição de alturas, podemos utilizar o conjunto de dados para estimar os parâmetros da população e calcular quais seriam estas probabilidades.\n\n\n:::{.callout-note}\n# Um pouco de história\n\nAlguns atribuem a proposição deste modelo normal a <a href=\"https://en.wikipedia.org/wiki/Abraham_de_Moivre\" target=\"_blank\">Abraham de Moivre</a>, um matemático Francês que chegou a a distribuição normal como uma aproximação a <a href=\"https://en.wikipedia.org/wiki/Binomial_distribution\" target=\"_blank\">distribuição binomial</a> em seu livro <a href=\"https://en.wikipedia.org/wiki/The_Doctrine_of_Chances\" target=\"_blank\">The Doctrine of Chances</a> em $1718$. A **distribuição normal** de probabilidades é **simétrica**, ou seja, os valores extremos são igualmente representados acima e abaixo da região central (média). Você poderá encontrar o termo *bell curve* em inglês, devido à sua forma de sino, ou ainda distribuição **gaussiana** em homenagem a <a href=\"https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss\" target=\"_blank\">Carl Friedrich Gauss</a> um dos mais importantes matemáticos do século XXI. Gauss lidou com a distribuição normal quando desenvolveu a **Teoria da distribuição dos erros observacionais** no contexto do <a href=\"https://en.wikipedia.org/wiki/Least_squares\" target=\"_blank\">Método dos Mínimos Quadrados</a> em $1823$.\n\n:::\n\n## Entendendo a função normal\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nA função $f(x) = \\frac{1}{\\sqrt(2\\pi\\sigma^2)}e^{-\\frac{1}{2}(\\frac{x-\\mu}{\\sigma})^2}$ é uma **função de densidade de probabilidade**. Antes de aplicar esta distribuição para encontrar valores de probabilidade, vamos aprender simplesmente para descrever a funções de densidade assumindo valores particulares de $\\mu$ e $\\sigma$. Para isto, vamos tentar simular o histograma de alturas similar ao da @fig-exemplos-norm. Vamos assumir que a distribuição de alturas tenha a seguinte media e desvio padrão:\n\n$\\mu = 1.7$ metros\n\n$\\sigma = 0.09$ metros\n\nPara uma determinada altura $x = 1.6$ metros, a $f(x)$ assume o valor:\n\n$f(1.6) = \\frac{1}{\\sqrt(2\\pi \\times0.09^2)}e^{-\\frac{1}{2}(\\frac{1.6 - 1.7}{0.09})^2} = 2.391$\n\nEste resultado corresponde ao ponto $y$ no gráfico da distribuição normal (@fig-fx-norm) em que $x = 1.6$. Podemos encontar $f(x)$ para quaisquer valores dentro dos reais $\\mathbb{R}$ entre $-\\infty$ e $+\\infty$.\n\nAssim, se calcularmos $f(x)$ para diferentes pontos em $x$ teremos um esboço da função de densidade normal. Na @fig-fx-norm, por exemplo, apresentamos $f(x)$ para os valores:\n\n$X = 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2$\n\nassumindo $\\mu = 1.7$ e $\\sigma = 0.09$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Pontos na distribuição normal de densidade de probrabilidade.](distr-norm_files/figure-html/fig-fx-norm-1.png){#fig-fx-norm width=768}\n:::\n:::\n\n\n\n\n### Calculando de $f(x)$ no R: a função `dnorm()`\n\nNo R, os resultados acima podem ser obtidos com a função `dnorm()`, que fornece um modo simples para calcularmos $f(x)$ na distribuição normal. Nesta função a letra 'd' vem de *densidade* da distribuição normal.\n\nPara encontrar $f(x)$ para um dado valor fazemos simplesmente:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 1.7\ndp <- 0.11\ndnorm(1.5, mean = mu, sd = dp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6945048\n```\n\n\n:::\n:::\n\n\n\n\nSe quisermos obter $f(x)$ para múltiplos valores de $x$ podemos fazer:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(1.4, 1.5, 1.6, 1.7)\ndnorm(x, mean = mu, sd = dp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0879777 0.6945048 2.3991470 3.6267480\n```\n\n\n:::\n:::\n\n\n\n\n## Cálculo de probabilidade com a função normal de densidade\n\nEncontrar a probabilidade de uma variável aleatória $X$ estar dentro de uma deteminada faixa de valores significa fazer **predições** a respeito da probabilidade de ocorrência de uma observação futura. Por ser uma função de probabilidade, a área abaixo de $f(x)$ na distribuição normal é igual a $1$. \n\n$$P(-\\infty \\le X \\le +\\infty) = \\int_{-\\infty}^{+\\infty}f(x) dx = 1$$\n\nAssim, se desejamos obter probabilidade de uma variável estar dentro de um determinado limite, devemos calcular a **área abaixo da curva** para este limite. Por exemplo, a probabilidade de uma observação em $X$ estar entre $x_1$ e $x_2$ será:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Representação das probabilidades de um intervalo da distribuição normal de densidade.](distr-norm_files/figure-html/fig-areas-interrvalo-norm-1.png){#fig-areas-interrvalo-norm width=768}\n:::\n:::\n\n\n\n\n\n### Calculando probabilidades no R: a função `pnorm()`\n\nUsando o R, a probabilidade de amostrarmos um aluno que tenha entre menos de $1.5$ metros pode ser obtida por meio da função `pnorm`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 1.7\ndp <- 0.11\npnorm(q = 1.5, mean = mu, sd = dp, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.03451817\n```\n\n\n:::\n:::\n\n\n\n\n\n:::{.callout-note}\n\n# Argumentos da função:\n\n**q**: o valor de $x$\n\n**mean**: média $\\mu$ da função normal\n\n**sd**: desvio padrão $\\sigma$ da função normal\n\n**lower.tail**: se a função irá retornar a probabilidade abaixo (TRUE) ou acima (FALSE) de q\n\n*veja o menu de ajuda digitando `?pnorm` no Console do R*\n\n:::\n\nSe quisermos encontrar a probabilidade $P(X \\ge 1.5)$ alteramos o parâmetro `lower.tail`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 1.5, mean = mu, sd = dp, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9654818\n```\n\n\n:::\n:::\n\n\n\n\nSe desejamos obter a probabilidade de $x$ estar **entre** $1.5$m e $1.7$m podemos fazer: $$P(1.5 \\le X \\le 1.7) = P(X \\le 1.7) - P(X \\le 1.5)$$\n\nNo R temos:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- pnorm(q = 1.7, mean = mu, sd = dp, lower.tail = TRUE)\np2 <- pnorm(q = 1.5, mean = mu, sd = dp, lower.tail = TRUE)\npfinal <- p1 - p2\n\npfinal\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4654818\n```\n\n\n:::\n:::\n\n\n\n\nou simplesmente:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiff(pnorm(q = c(1.7, 1.5),\n           mean = mu,\n           sd = dp,\n           lower.tail = TRUE)\n     )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.4654818\n```\n\n\n:::\n:::\n\n\n\n\nAqui estão representados cada um dos intervalos calculados.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndfc <- data.frame(X = seq(0, sup, length.out = 10000)) |>\n  dplyr::mutate(dx = dnorm(X, mean = mu, sd = dp))\n\ngc1 <- ggplot(dfc, aes(x = X, y = dx)) +\n  stat_function(fun = dnorm, args = list(mean = mu, sd = dp)) +\n  geom_area(\n    data = subset(dfc, X <= 1.7),\n    fill = \"#eb4034\", color = NA, alpha = 0.5\n  ) +\n  scale_x_continuous(\n    name = \"X\",\n    limits = c(1.4, 2),\n    breaks = seq(1.4, 2, by = 0.05)\n  ) +\n  ylab(\"f(x)\") +\n  annotate(\n    \"text\", x = 1.5, y = 3,\n    label = as.expression(bquote(P(X <= 1.7) == .(round(p1, 3)))),\n    color = \"#eb4034\"\n  ) +\n  theme_classic()\n\ngc2 <- ggplot(dfc, aes(x = X, y = dx)) +\n  stat_function(fun = dnorm, args = list(mean = mu, sd = dp)) +\n  geom_area(\n    data = subset(dfc, X <= 1.5),\n    fill = \"#eb4034\", color = NA, alpha = 0.5\n  ) +\n  scale_x_continuous(\n    name = \"X\",\n    limits = c(1.4, 2),\n    breaks = seq(1.4, 2, by = 0.05)\n  ) +\n  ylab(\"f(x)\") +\n  annotate(\n    \"text\", x = 1.5, y = 3,\n    label = as.expression(bquote(P(X <= 1.5) == .(round(p2, 3)))),\n    color = \"#eb4034\"\n  ) +\n  theme_classic()\n\ngc3 <- ggplot(dfc, aes(x = X, y = dx)) +\n  stat_function(fun = dnorm, args = list(mean = mu, sd = dp)) +\n  geom_area(\n    data = subset(dfc, X >= 1.5 & X <= 1.7),\n    fill = \"#eb4034\", color = NA, alpha = 0.5\n  ) +\n  scale_x_continuous(\n    name = \"X\",\n    limits = c(1.4, 2),\n    breaks = seq(1.4, 2, by = 0.05)\n  ) +\n  ylab(\"f(x)\") +\n  annotate(\n   \"text\",\n   x = 1.5, y = 3,\n   label = as.expression(\n      substitute(P(a <= X * \",\" ~ X <= b) == val,\n                  list(a = 1.5, b = 1.7, val = round(pfinal, 3)))\n   ),\n   color = \"#eb4034\"\n   ) +\n  theme_classic()\n\ngc1 / gc2 / gc3\n```\n\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n\n\n\n\n\n## A distribuição normal padronizada\n\nA integral para a função normal é difícil de ser calculada pois não tem solução analítica. Isto era um problema para os cientistas até meados do século $XX$ que precisavam calcular valores de probabilidades para diferentes combinações de $\\mu$ e $\\sigma$. Naquele momento, a solução para facilitar a vida dos pesquisadores foi criar uma tabela descrevendo estas probabilidades em uma distribuição normal **padronizada**, ou seja para valores particulares de $\\mu$ e $\\sigma$. Padronizar aqui, significa transfomar cada valor $x_i$ de modo que as observações resultantes tenham média igual a $0$ e desvio padrão igual a $1$. \n\nEsta transformação é apicada a cada observação $x_i$, obtendo-sem um valor de $z_i$ correspondente por meio da expressão.\n\n$$z_i = \\frac{x_i - \\mu}{\\sigma}$$\n\nA transformação $Z$ é útil, pois ainda que seja difícil calcular as probabilidades para uma variável aleatória $X$, após a transformação teremos uma variável $Z$ para a qual os valores de probabilidade estão **tabelados**. Deste modo, $Z$ é uma variável aleatória com $\\overline{z} = 0$ e $s = 1$ tal que:\n\n$$Z \\sim \\mathcal{N}(0,\\,1)$$\n\nApós a transformação $Z$ nos exemplos sobre altura dos alunos e da temperatura mensal temos: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nie <- ie |> \n   mutate(ALTURA_z = (ALTURA - mean(ALTURA, na.rm = T))/sd(ALTURA, na.rm = T))\ntemp <- temp |> \n   mutate(tm_z = (tm - mean(tm, na.rm = T))/sd(tm, na.rm = T))\n\naltz_plt <- ggplot(ie, aes(x = ALTURA_z)) +\n   geom_histogram(aes(y = after_stat(density)), \n                  fill = 'dodgerblue4', \n                  color = 'black', bins = 10) +\n   stat_function(fun = dnorm, \n                 args = list(mean = mean(ie$ALTURA_z, na.rm = T),\n                                          sd = sd(ie$ALTURA_z, na.rm = T))) +\n   labs(x = \"Distribuição Z\",\n        y = \"Frequencia relativa\") +\n   theme_classic()\n\ntempz_plt <- ggplot(temp, aes(x = tm_z)) +\n   geom_histogram(aes(y = after_stat(density)),\n                  fill = 'dodgerblue4', \n                  color = 'black', bins = 10) +\n   stat_function(fun = dnorm, \n                 args = list(mean = mean(temp$tm_z, na.rm = T),\n                                          sd = sd(temp$tm_z, na.rm = T))) +\n   labs(x = \"Distribuição Z\",\n        y = \"Frequencia relativa\") +\n   theme_classic()\n\n(alt_plt | temp_plt) / \n  (altz_plt | tempz_plt)\n```\n\n::: {.cell-output-display}\n![Distribuição das variáveis originais e após a transformação Z.](distr-norm_files/figure-html/fig-exe-distZ-1.png){#fig-exe-distZ width=768}\n:::\n:::\n\n\n\n\n:::{.callout-note}\n# Escore Z\n\nO escore Z pode ser apresentado como uma **medida de posição** de uma observação na amostra ($z_i$) que representava uma medida **relativa** desta observação com relaçao à média e ao desvio padrão do conjunto de dados. Por exemplo, um valor de $z_i = 2$ significa que a observação original $x_i$ está $2$ desvios padrões **acima** de sua respectiva média $\\mu$.\n\n:::\n\n### Probabilidades em uma distribuição normal padronizada\n\nNos dois exemplos anteriores, verifica-se que todas as observações estão situadas, aproximadamente, entre $z = -3$ e $z = +3$. De fato, a distribuição normal padronizada ou **distribuição Z** tem propriedades bem conhecidas. Como sua média é $\\mu = 0$ e seu desvio padrão é $\\sigma = 1$, a maior parte das observações fica limitada entre  $z = -3$ e $z = +3$. Para ser exato, podemos descrever as probabilidades de uma observação estar dentro de alguns limites conhecidos. Por exemplo, $95\\%$ das observações estará entre $z = -1.96$ e $z = +1.96$, isto é, \n\n$$P(-1.96 \\le Z \\le +1.96) = 0.95$$\n\nDe forma similar, $90\\%$ da área central da curva se encontra entre $z = -1.64$ e $z = +1.64$. Estes e outros limites na distribuição normal padronizada podem ser verificados na figura abaixo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Ver função completa no arquivo 'scripts/normal-empirica-gg.r'\nnormal_empirica_gg(xlabels = c(-4:4))\n```\n\n::: {.cell-output-display}\n![Áreas de probabilidade em uma distribuição Normal Padronizada (Distribuição Z).](distr-norm_files/figure-html/fig-normal-empirica-gg-1.png){#fig-normal-empirica-gg width=672}\n:::\n:::\n\n\n\n\nVamos exemplificar o uso da distribuição $Z$ no cálculo de probabilidades utilizando os dados de altura dos alunos. Para estes dados, iremos encontrar $P(X \\le 1.5)$. Este procedimento consiste de:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmu <- 1.7\ndp <- 0.11\nx <- 1.5\nz_1.5 <- (x - mu)/dp\n```\n:::\n\n\n\n\n1. Transformar $x = 1.5$ em $z_{1.5}$ por meio de $z_{1.5} = \\frac{1.5 - 1.7}{0.11} = -1.818$;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmu <- 1.7\ndp <- 0.11\nx <- 1.5\nz_1.5 <- (x - mu)/dp\n\nz_1.5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.818182\n```\n\n\n:::\n:::\n\n\n\n\n2. Encontrar encontrar $P(Z \\le z_{1.5}) = P(Z \\le -1.818) = 0.0345182$. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npnorm(q = z_1.5, mean = 0, sd = 1, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.03451817\n```\n\n\n:::\n:::\n\n\n\n\nCompare este resultado com o obtido anteriormente para verificar que é equivalente a $P(X \\le 1.5)$. \n\n:::{.callout-note}\n\n# A transformação $Z$\n\nSuponha uma variável aleatória $X$ nomalmente distribuída conforme $X \\sim \\mathcal{N}(\\mu,\\,\\sigma^2)$. Desejamos encontrar $m$ tal que:\n\n$P(X \\le m) = \\alpha$\n\n> $\\alpha$ aqui representa um valor de probabilidade qualquer determinada pela área na distribuição normal **abaixo** de $m$.\n\nAo aplicar a transformação $Z$ teremos:\n\n$P(\\frac{X - \\mu}{\\sigma} \\le \\frac{m - \\mu}{\\sigma}) = \\alpha$\n\ncomo $\\frac{X - \\mu}{\\sigma} = Z$ temos que:\n\n$P(Z \\le \\frac{m - \\mu}{\\sigma}) = \\alpha$\n\nPor meio desta expressão, você pode encontar $m$ uma vez fornecido $\\alpha$ ou encontrar $\\alpha$, desde que seja fornecido $m$.\n\nO mesmo vale se quisermos encontrar a probabilidade determinada por um intervalo definido de $m$ até $n$ ($m < n$). Para isto fazemos:\n\n$P(m \\le X \\le n) = \\alpha$\n\n$P(\\frac{m - \\mu}{\\sigma} \\le \\frac{X - \\mu}{\\sigma} \\le \\frac{n - \\mu}{\\sigma}) = \\alpha$\n\n$P(\\frac{m - \\mu}{\\sigma} \\le Z \\le \\frac{n - \\mu}{\\sigma}) = \\alpha$\n\n:::\n\n### Tabela $Z$\n\nAo utilizarmos um software estatístico não é necessário fazer esta transformação. A transformação $Z$ era necessária na ausência de ferramentas computacionais, ou seja, quando a única opção era utilizarmos a Tabela $Z$ para evitar cálculos tediosos considerando cada combinação de $\\mu$ e $\\sigma$. \n\n\nA <a href=\"https://github.com/FCopf/datasets/blob/main/Tabela_Z.pdf\" target=\"_blank\">Tabela Z</a> disponibiliza os valores de probabilidade para um grande número de valores e é apresentada na grande maioria dos livros de estatística.\n\nVocê pode utilizar a Tabela $Z$ para encontrar $P(X \\le 1.5)$. Note que o valor transformado é $z_{1.5} = -1.818$. Este será o valor que iremos buscar na tabela. Para isto:\n\n1. Encontre a página que oferece valores **negativos**, uma vez que $z_{1.5} < 0$;\n\n2. Na coluna 1 desta página (coluna **z**) encontre a linha **-1.8** que refere-se à unidade, e à primeira casa decimal de $z_{1.5}$;\n\n3. Encontre a coluna **0.02** (quarta coluna da tabela $Z$) que apresenta a segunda casa decimal de $z_{1.5}$. Isto nos leva ao valor mais próximo do calculado ($z_{1.5} = -1.818$). \n\n4. Cruze a **linha** escolhida no item 3 com a **coluna** escolhida no item 4. Você irá encontrar o valor $0,0344$. Este valor e a probabilidade de obtermos um valor de $z \\le 1.5$ na distribuição normal padronizada, ou seja, $P(Z \\le z_{1.5})$. A diferença entre este valor e o encontrado com o R se deve unicamente ao limite de precisão na Tabela $Z$.\n\n## Exercícios resolvidos\n\n### Distribuição de comprimento\n\nAs comunidades de peixes em riachos de cabeceira são compostas por espécies de pequeno porte. *Rhamdioglanis transfasciatus* é uma destas espécies, desconhecida  do público em geral, porém muito abundante em pequenos riachos bem preservados. Dados de captura sugerem que o tamanho dos indivíduos pode ser razoavelmente bem descrito por um modelo de distribuição normal.\n\nImporte a base de dados `rhamdioglanis.csv`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrh <- read_delim('https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/rhamdioglanis.csv', delim = ';',\n                 locale = locale(decimal_mark = ','))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(rh, aes(x = Comprimento)) +\n   geom_histogram(aes(y = after_stat(density)),\n                  fill = 'dodgerblue4', color = 'black', bins = 15) +\n   stat_function(fun = dnorm, args = list(mean = mean(rh$Comprimento),\n                                          sd = sd(rh$Comprimento))) +\n   labs(x = 'Comprimento de Rhamdioglanis transfasciatus (cm)',\n        y = 'Densidade') +\n   theme_classic()\n```\n\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\nSuponha o comprimento desta espécie tenha uma distribuição normal com $\\mu = 10$ cm e $\\sigma = 3$ cm. Encontre:\n\ni. A probabilidade de capturar um indivíduo maior de 14 cm de comprimento, $P(X \\ge 14)$.\nii. A probabilidade de capturar um indivíduo menor de 5 cm de comprimento, $P(X \\le 5)$.\niii. A probabilidade de encontrar um indivíduo **entre** 5 e 14 cm, $P(5 \\le X \\le 14)$.\niv. Se um trecho de riacho contém 800 indivíduos, quantos são maiores que 14 cm de comprimento.\n   \n**RESOLUÇÃO**\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n:::{.callout-tip collapse=\"true\"}\n\n# $P(X \\ge 14)$\n\nVamos encontrar o respectivo valor de $Z$ pela transformação\n\n$z_{14} = \\frac{14 - 10}{3} = 1.33$\n\nNa tabela $Z$ procuramos a linha que mostra a unidade e $1^a$ casa decimal de $1.33$ e em seguida encontramos a coluna que representa a $2^a$ casa decimal de $1.33$. Cruzando linha e coluna encontramos o valor $0,9082$. Note que este valor representa  a área **abaixo** de 1.33, isto é, $P(Z \\le z_{14})$. No entanto, queremos $P(Z \\ge z_{14})$ que representa a área da curva **acima** de $1.33$. Para isto basta fazermos $1 - 0,9082$.\n\nDeste modo, $P(Z \\ge z_{14}) = 1 - P(Z \\le z_{14}) = 1 - 0,9082 = 0.0918$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# ii. $P(X \\le 5)$\n\n$z_{5} = \\frac{5 - 10}{3} = -1.67$\n\nNa tabela $Z$ procuramos a linha que mostra a unidade e $1^a$ casa decimal de $-1.67$ e em seguida encontramos a coluna que representa a $2^a$ casa decimal de $-1.67$. Cruzando linha e coluna encontramos o valor $0,0475$ que representa a área desejada.\n\nDeste modo, $P(X \\le 5) = P(Z \\le z_{5}) = 0,0475$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# iii. $P(5 \\le X \\le 14)$\n\nVamos subtrair as quantias $P(Z \\le 14) - P(Z \\le 5)$\n\nEstes valores já foram encontrados nos itens anteriores, de modo que basta fazermos:\n\n$P(5 \\le X \\le 14) = 0,9082 - 0,0475 = 0.8607$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# iv. Indivíduos maiores que 14 cm de comprimento\n\nSe a proporção de indivíduos acima de 14 é $P(X > 14) = 0.0918$ e a população tem $N = 800$ indivíduos, teremos:\n\n$0.0918 \\times 800 = 73$ indivíduos maiores que 14 cm.\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# RESOLUÇÃO no R\n\nO exercício pode ser resolvido pelo R por meio da função `pnorm`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 10\nsigma <- 3\nN <- 800\nla <- 14\nlb <- 5\n```\n:::\n\n\n\n\n___\n\n**i. $P(Z \\ge 14)$**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = la, mean = mu, sd = sigma, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.09121122\n```\n\n\n:::\n:::\n\n\n\n\n\n___\n\n**ii. $P(Z \\le 5)$**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = lb, mean = mu, sd = sigma, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.04779035\n```\n\n\n:::\n:::\n\n\n\n\n___\n\n**iii. $P(5 \\le X \\le 14)$**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiff(\n   pnorm(q = c(lb, la),\n         mean = mu,\n         sd = sigma,\n         lower.tail = TRUE)\n   )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8609984\n```\n\n\n:::\n:::\n\n\n\n\n___\n\n**iv. Número de indivíduos maiores que $14$ cm de comprimento**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_la <- pnorm(q = la, mean = mu, sd = sigma, lower.tail = FALSE)\n\nN * pg_la\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 72.96898\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n### Intervalos em uma distribuição normal\n\nSuponha variável aleatória $X$ normalmente distribuída conforme com $\\mu = 50$ e $\\sigma = 10$. Encontre:\n\ni. O valor de $a$ tal que $P(X \\le a) = 0,10$.\nii. O valor de $b$ tal que $P(X \\ge b) = 0,85$.\niii. O intervalo simétrico ao redor da média delimitado por $c$ e $d$ ($c < d$), que contém $95\\%$ da área sob a curva.\niv. O valor de $e$ tal que $P(50-e \\le X \\le 50+e) = 0.99$\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n___\n\n**RESOLUÇÃO**\n\nVeja que neste exercício, foram oferecidos valores de probabilidades e solicitado que você obtivesse os limites em uma distribuição normal específica. Este processo é oposto ao do excercício anterior.\n\n:::{.callout-tip collapse=\"true\"}\n\n# i. O valor de $a$\n\nSe $P(X \\le a) = 0,10$, a área da curva abaixo de $a$ é $0,10$. Procurando por este valor na tabela $Z$ vemos que o valor mais próximo é $0,1003$ que corresponde a um escore $z = -1,28$. Vamos utilizar este valor para encontrar sua correspondência para a variável aleatória $X$ que tem média $\\mu = 50$ e desvio padrão $\\sigma = 10$.\n\n$z = \\frac{a - \\mu}{\\sigma} :: -1,28 = \\frac{a - 50}{10}$\n\n$a = (-1,28 \\times 10) + 50 = 37.2$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# ii. O valor de $b$\n\nSe $P(X \\ge b) = 0,85$, a área abaixo de $b$ que devemos encontrar na tabela $Z$ é $1 - 0,85 = 0.15$. Vemos que o valor mais próximo é $0,1492$ que corresponde a $z = -1,04$. Ao utilizar este resultado na expressão abaixo temos:\n\n$z = \\frac{b - \\mu}{\\sigma} :: -1,04 = \\frac{b - 50}{10}$\n\n$b = (-1,04 \\times 10) + 50 = 39.6$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# O intervalo simétrico ao redor da média delimitado por $c$ e $d$ ($c < d$), que contém $95\\%$ da área sob a curva.\n\nSe entre $c$ e $d$ está $95\\%$ da área da curva, temos uma área de $1 - 0,95 = 0,05$ fora da curva. Como o intervalo é simétrico, teremos $0,025$ abaixo de $c$ e $0,025$ acima de $d$.\n\nAo procurar na tabela $Z$ por $0,025$ encontraremos $z = -1,96$ que equivale ena distribuição de X a:\n\n$z = \\frac{c - \\mu}{\\sigma} :: -1,96 = \\frac{c - 50}{10}$\n\n$c = (-1,96 \\times 10) + 50 = 30.4$\n\nNovamente, como o intervalo é simétrico e a dsitribuição de $Z$ é centrada em zero, o ponto $d$ será de +$1,96$ que resulta em:\n\n$z = \\frac{d - \\mu}{\\sigma} :: +1,96 = \\frac{d - 50}{10}$\n\n$d = (+1,96 \\times 10) + 50 = 69.6$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# iv. O valor de $e$ tal que $P(50-e \\le X \\le 50+e) = 0.99$\n\nPodemos fazer aqui:\n\n$P(50-e \\le X \\le 50+e) = P(\\frac{50-e - \\mu}{\\sigma} \\le \\frac{X-\\mu}{\\sigma} \\le \\frac{50+e-\\mu}{\\sigma}) = 0.99$\n\ncomo $\\mu = 50$ e $\\sigma = 10$ temos:\n\n$P(\\frac{-e}{10} \\le Z \\le \\frac{e}{10}) = 0.90$\n\nComo a área central ocupa $0,99$ da distribuição, restam $0,005$ na cauda **superior** e $0,005$ na cauda **inferior**:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](distr-norm_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\n\nPara encontrar $-e$ buscamos por $0,005$ na tabela $Z$ e encontramos $0,0051$ como valor mais próximo, referente a $z_{-e} = -2,57$. Substituindo na equação temos:\n\n$\\frac{-e}{10} \\le -2,57 :: -e = -2,57 \\times 10 :: e = 25,7$\n\n*Note na figura acima que os limite das áreas em azul são: \n\n$\\mu - e = 50 - 25.7 = 24.3$ e \n\n$\\mu - e = 50 + 25.7 = 75.7$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# RESOLUÇÃO no R\n\nO exercício pode ser resolvido pelo R por meio da função `qnorm`.\n\n> Em `qnorm`, o 'q' vem de *quantis* da distribuição normal.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu = 50\nsigma = 10\n\n(a <- qnorm(p = 0.10, mean = mu, sd = sigma, lower.tail = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 37.18448\n```\n\n\n:::\n\n```{.r .cell-code}\n(b <- qnorm(p = 1-0.85, mean = mu, sd = sigma, lower.tail = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 39.63567\n```\n\n\n:::\n\n```{.r .cell-code}\n(c <- qnorm(p = (1-0.95)/2, mean = mu, sd = sigma, lower.tail = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 30.40036\n```\n\n\n:::\n\n```{.r .cell-code}\n(d <- qnorm(p = (1-0.95)/2, mean = mu, sd = sigma, lower.tail = FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 69.59964\n```\n\n\n:::\n\n```{.r .cell-code}\n(e <- -qnorm(p = (1-0.99)/2, mean = mu, sd = sigma, lower.tail = TRUE) + 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 25.75829\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n### Quantos desvios padrões?\n\nSuponha uma variável aleatória normalmente distribuída representada por $X \\sim \\mathcal{N}(\\mu,\\,\\sigma^2)$, determine:\n\ni. O valor de $a$ tal que $P(X < a) = 0,20$.\nii. $P(X \\le \\mu + 2\\sigma)$.\niii. O valor de $c$ tal que $P(\\mu -c\\sigma \\le X \\le \\mu +c\\sigma) = 0.99$\n\n**RESOLUÇÃO**\n\n:::{.callout-tip collapse=\"true\"}\n\n# i. O valor de $a$ tal que $P(X < a) = 0,20$.\n\n$P(X < a) = P(\\frac{X - \\mu}{\\sigma} < \\frac{a - \\mu}{\\sigma}) = P(Z < \\frac{a - \\mu}{\\sigma}) = 0,20$\n\nProcurando pelo valor de $z$ que delimita $0,20$ da área abaixo de $a$ encontramos por $z = -0,84$, de modo que:\n\n$-0,84 = \\frac{a - \\mu}{\\sigma}$\n\n$a = \\mu -0,84\\sigma$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# ii. $P(X \\le \\mu + 2\\sigma)$\n\nA expressão $\\mu + 2\\sigma$ nos diz que o limite de interesse está $2$ desvios padrões **acima** de $\\mu$. Ao procurar pelo valor de $z = 2,0$ na tabela $Z$, veremos que a probabilidade de interesse é $P(X \\le \\mu + 2\\sigma) = 0,9772$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n\n# iii. O valor de $c$ tal que $P(\\mu -c\\sigma \\le X \\le \\mu +c\\sigma) = 0.99$\n\nDesenvolvendo esta expressão teremos\n\n$P(-c \\le \\frac{X - \\mu}{\\sigma} \\le +c) = P(-c \\le Z \\le +c) = 0.99$\n\nFora deste intervalo simétrico, teremos uma área de $0,005$ na cauda inferior e $0,005$ na cauda superior da distribuição $Z$.\n\nAo procurar por $0,005$ na tabela $Z$ encontramos $z = -2,57$, de modo que $c = 2,57$.\n\n:::\n\n:::{.callout-note}\n\n# Vídeo-aulas\n\n<iframe\n  style=\"width:100%; aspect-ratio:16/9;\"\n  src=\"https://www.youtube-nocookie.com/embed/LSjY2yUp4tc\"\n  title=\"YouTube video player\"\n  frameborder=\"0\"\n  allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n  allowfullscreen>\n</iframe>\n\n:::\n",
    "supporting": [
      "distr-norm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}