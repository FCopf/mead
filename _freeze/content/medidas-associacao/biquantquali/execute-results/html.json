{
  "hash": "a4060e4dc1e4cf4f9f0896d4cd3a59ac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Associação entre variáveis quantitativas e qualitativas\" \ndescription: \"Análise da relação entre variáveis quantitativas e categóricas, considerando partição da soma de quadrados e coeficientes de determinação.\"\ncategories: [\n          \"Estatística\",\n          \"ANOVA\",\n          \"Análise quantitativa\",\n          \"Análise qualitativa\",\n          \"Medidas de associação\"\n        ]\n\nimage: \"images/biquantquali.jpg\"\nexecute:\n  echo: true\n  warning: false\n  include: true\n  message: false\n---\n\n\n\n\n:::{.callout-tip collapse=\"true\"}\n## Pacotes e funções utilizadas no capítulo\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(patchwork)\nlibrary(gridExtra)\nsource('scripts/anova-sim.r')\n```\n:::\n\n\n\n\n:::\n\nNeste capítulo vamos descrever a associação entre uma variável $Y$ contínua e uma variável  $X$ categórica denominadas respectivamente de variável **dependente** (ou **resposta**) e variável **independente** (ou **preditora**)\n\nAssumimos *explicitamente* que $Y$ é função (depende) de $X$ e não o contrário. O nome variável preditora vem do fato que, se $Y$ e $X$ estão associadas, ao conhecemos $X$ somos capazer de *predizer* a resposta média em $Y$.\n\n## Visualizando a distribuição de $Y$ em diferentes grupos\n\nImporte a base de dados `medley.csv` (disponível também em [Chapter 10 - Single factor classification (ANOVA)](https://users.monash.edu.au/~murray/BDAR/){target=\"_blank\"}) que avalia o impacto da presença de metais pesados na diversidade de espécies de diatomácias em riachos (@medleyclements1998; @queen2002experimental; @logan2011biostatistical).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedley = read_csv(\"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/medley.csv\") |> \n  mutate(STREAM = factor(STREAM),\n         ZINC = factor(ZINC, ordered = TRUE,\n                       levels = c(\"BACK\", \"LOW\", \"MED\", \"HIGH\")))\nvar_medley = colnames(medley)\nstream_levels = levels(medley$STREAM)\nn_stream = nlevels(medley$STREAM)\nzinc_levels = levels(medley$ZINC)\nn_zinc = nlevels(medley$ZINC)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmedley |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"oaneuxgpsf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oaneuxgpsf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oaneuxgpsf thead, #oaneuxgpsf tbody, #oaneuxgpsf tfoot, #oaneuxgpsf tr, #oaneuxgpsf td, #oaneuxgpsf th {\n  border-style: none;\n}\n\n#oaneuxgpsf p {\n  margin: 0;\n  padding: 0;\n}\n\n#oaneuxgpsf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oaneuxgpsf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oaneuxgpsf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oaneuxgpsf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oaneuxgpsf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oaneuxgpsf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oaneuxgpsf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oaneuxgpsf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oaneuxgpsf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oaneuxgpsf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oaneuxgpsf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oaneuxgpsf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oaneuxgpsf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oaneuxgpsf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oaneuxgpsf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oaneuxgpsf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oaneuxgpsf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oaneuxgpsf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oaneuxgpsf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oaneuxgpsf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oaneuxgpsf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oaneuxgpsf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oaneuxgpsf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oaneuxgpsf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oaneuxgpsf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oaneuxgpsf .gt_left {\n  text-align: left;\n}\n\n#oaneuxgpsf .gt_center {\n  text-align: center;\n}\n\n#oaneuxgpsf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oaneuxgpsf .gt_font_normal {\n  font-weight: normal;\n}\n\n#oaneuxgpsf .gt_font_bold {\n  font-weight: bold;\n}\n\n#oaneuxgpsf .gt_font_italic {\n  font-style: italic;\n}\n\n#oaneuxgpsf .gt_super {\n  font-size: 65%;\n}\n\n#oaneuxgpsf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oaneuxgpsf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oaneuxgpsf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oaneuxgpsf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oaneuxgpsf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oaneuxgpsf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oaneuxgpsf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oaneuxgpsf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oaneuxgpsf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"STREAM\">STREAM</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ZINC\">ZINC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIVERSITY\">DIVERSITY</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Eagle</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.27</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Eagle</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.25</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Eagle</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.15</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Eagle</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.62</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.70</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">0.63</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.05</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.98</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.04</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.19</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Blue</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.10</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Snake</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.20</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Snake</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.06</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Snake</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.90</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Snake</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.88</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Snake</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">0.85</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.40</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.18</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.83</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.88</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.02</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.94</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Arkan</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.10</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Chalk</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.38</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Chalk</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.43</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Chalk</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.37</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Chalk</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.75</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Chalk</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">2.83</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.53</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">0.76</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">0.80</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.66</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">0.98</td></tr>\n    <tr><td headers=\"STREAM\" class=\"gt_row gt_center\">Splat</td>\n<td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"DIVERSITY\" class=\"gt_row gt_right\">1.89</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nA coluna STREAM é uma variável categórica contendo o nome dos $6$ riachos amostrados (Arkan, Blue, Chalk, Eagle, Snake, Splat). A coluna ZINC é uma variável categórica ordinal com $4$ níveis de concentração de zinco na água (BACK < LOW < MED < HIGH). O primeiro nível (BACK) é o nível de referência (**BACKGROUND**). Finalmente, a coluna DIVERSITY é uma variável contínua que contém a diversidade de diatomácieas (medida pelo índice de diversidade de [Shannon](https://pt.wikipedia.org/wiki/%C3%8Dndice_de_Shannon){target=\"_blank\"} medida de cada uma das 34 amostras.\n\nVamos nos concentrar nas variáveis DIVERSITY e ZINC. DIVERSITY será a variável resposta. Em delineamento experimental, dizemos que ZINC é um **tratamento**, isto é, uma condição experimental sob a qual nossa variável dependente $Y$ foi mensurada. \n\nPara verificarmos a distribuição de diversidade para cada concentração de zinco poderíamos fazer um gráfico de dispersão. A diferença agora é que $X$ trata-se de uma variável categórica ordinal com $4$ níveis.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(medley) +\n  aes(x = ZINC, y = DIVERSITY) +\n  geom_point() +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Boxplots para os níveis do tratamento\n\nNão há problema em apresentarmos um gráfico de dispersão. No entanto, em situações deste tipo estamos comumente interessados em representar medidas-resumo que nos permitam comparar os diferentes níveis do tratamento. A forma mais comum de representar esta situação é por meio de um boxplot para cada nível do tratamento.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(medley) +\n  aes(x = ZINC, y = DIVERSITY) +\n  geom_boxplot() +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\nNa figura acima estão representadas a mediana, os quartis ($1^o$ e $3^o$) e os pontos máximo e mínimo para cada nível do tratamento. Alguns pontos extremos podem aparecer isoladamente para indicar que estão muito distantes dos demais. Podemos controlar esta representação com o argumento `coef` na função `geom_boxplot`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(medley) +\n  aes(x = ZINC, y = DIVERSITY) +\n  geom_boxplot(coef = 3) +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\nVemos que o boxplot referente ao nível HIGH está em uma posição inferior aos demais, sugerindo que a diversidade de diatomáceas tende a ser mais baixa para níveis elevados de zinco.\n\nExitem outras variações que podem nos ajudar a entender melhor os padrões. Podemos sobrepor os pontos individuais sobre os boxplots:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(medley) +\n  aes(x = ZINC, y = DIVERSITY) +\n  geom_boxplot(coef = 3) +\n  geom_point(size = 3) +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n### O gráfico de erros\n\nNas figuras acima representamos os quartis das distribuições. Podemos estar interessados em apresentar somente os **pontos médios** (média aritimética) juntamente com **barras de erro** que representem alguma medida de dispersão (ex. desvio padrão). Para isto é necessário inicialmente criar um `data.frame` com estas medidas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedley_barras = medley |> \n  group_by(ZINC) |> \n  summarise(Media = mean(DIVERSITY),\n            Desvio = sd(DIVERSITY))\nmedley_barras |> \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hevvhejjwc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hevvhejjwc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hevvhejjwc thead, #hevvhejjwc tbody, #hevvhejjwc tfoot, #hevvhejjwc tr, #hevvhejjwc td, #hevvhejjwc th {\n  border-style: none;\n}\n\n#hevvhejjwc p {\n  margin: 0;\n  padding: 0;\n}\n\n#hevvhejjwc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hevvhejjwc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hevvhejjwc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hevvhejjwc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hevvhejjwc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hevvhejjwc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hevvhejjwc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hevvhejjwc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hevvhejjwc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hevvhejjwc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hevvhejjwc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hevvhejjwc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hevvhejjwc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hevvhejjwc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hevvhejjwc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hevvhejjwc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hevvhejjwc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hevvhejjwc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hevvhejjwc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hevvhejjwc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hevvhejjwc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hevvhejjwc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hevvhejjwc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hevvhejjwc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hevvhejjwc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hevvhejjwc .gt_left {\n  text-align: left;\n}\n\n#hevvhejjwc .gt_center {\n  text-align: center;\n}\n\n#hevvhejjwc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hevvhejjwc .gt_font_normal {\n  font-weight: normal;\n}\n\n#hevvhejjwc .gt_font_bold {\n  font-weight: bold;\n}\n\n#hevvhejjwc .gt_font_italic {\n  font-style: italic;\n}\n\n#hevvhejjwc .gt_super {\n  font-size: 65%;\n}\n\n#hevvhejjwc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hevvhejjwc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hevvhejjwc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hevvhejjwc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hevvhejjwc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hevvhejjwc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hevvhejjwc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hevvhejjwc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hevvhejjwc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ZINC\">ZINC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Media\">Media</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Desvio\">Desvio</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"ZINC\" class=\"gt_row gt_center\">BACK</td>\n<td headers=\"Media\" class=\"gt_row gt_right\">1.797500</td>\n<td headers=\"Desvio\" class=\"gt_row gt_right\">0.4852613</td></tr>\n    <tr><td headers=\"ZINC\" class=\"gt_row gt_center\">LOW</td>\n<td headers=\"Media\" class=\"gt_row gt_right\">2.032500</td>\n<td headers=\"Desvio\" class=\"gt_row gt_right\">0.4449960</td></tr>\n    <tr><td headers=\"ZINC\" class=\"gt_row gt_center\">MED</td>\n<td headers=\"Media\" class=\"gt_row gt_right\">1.717778</td>\n<td headers=\"Desvio\" class=\"gt_row gt_right\">0.5030104</td></tr>\n    <tr><td headers=\"ZINC\" class=\"gt_row gt_center\">HIGH</td>\n<td headers=\"Media\" class=\"gt_row gt_right\">1.277778</td>\n<td headers=\"Desvio\" class=\"gt_row gt_right\">0.4268717</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nE em seguida plotar a figura.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(medley_barras, aes(x = ZINC)) +\n  geom_point(aes(y = Media), size = 3) +\n  geom_errorbar(aes(ymin = Media - Desvio,\n                    ymax = Media + Desvio), width = 0.4) +\n  labs(y = 'DIVERSITY') +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\nAqui vemos somente os pontos médios e as barras de erro, que estão à distância de $1$ desvio padrão acima e abaixo da média ($\\overline{Y} \\pm 1s$). Embora tenhamos expressado as distâncias utilizado o desvio padrão como medida de variação, poderíamos ter utilizado outras medidas como o **erro padrão** ou o **intervalo  de confiança** O importante é sempre deixar claro qual medida de variação está semdo representada no gráfico de erros (Veja: [Krzywinski & Altman, 2013 - Error bars - Points of Significance](https://www.nature.com/articles/nmeth.2659){target=\"_blank\"}).  \n\n## Partição das Soma dos Quadrados\n\nAo representarmos a distribuição de uma variável $Y$ contínua em função de uma variável $X$ categórica, geralmente estamos interessados em determinar se os diferentes níveis de $X$ (diferentes grupos) têm médias similares ou se ao menos um dos níveis têm média diferente dos demais. Queremos uma medida que nos permita diferenciar situações como as apresentadas abaixo.\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\nNa figura $A$ todos os grupos são provenientes da mesma distribuição e têm médias aproximadamente iguais ($\\overline{Y}_A \\approx  \\overline{Y}_B \\approx \\overline{Y}_C \\approx \\overline{Y}_D$). Na figura $B$ o segundo grupo tem média mais elevada que os demais, e na da figura $C$, todas as médias parecem ser diferentes entre si ($\\overline{Y}_A \\ne  \\overline{Y}_B \\ne \\overline{Y}_C \\ne \\overline{Y}_D$).\n\nPara mensurar o grau de associação entre $Y$ e $X$ e entender como podemos diferenciar as situações acima, vamos introduzir o processo de **Partição da Soma dos Quadrados**. \n\nSuponha a situção abaixo:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\n\n:::{.callout-note}\n\n## Notações\n\n+ Temos $k = 3$ grupos (`A`, `B` ou `C`) e para cada grupo $n =  5$ observações. Denotamos por $n_{ij}$ o número de observações dentro de cada grupo, em que $i$ é a *i-ésima* observação ($i = 1$ a $5$) do *j-ésimo* grupo ($j = 1$ a $3$ - grupos `A` ao `C`). Neste exemplo, o número de observações em cada grupo é o mesmo ($n_1 = n_2 = n_3 = n$), de modo que o total de observações é dado por:\n\n$N = k \\times n = n_1 + n_2 + n_3 = 15$\n\n+ A média de cada grupo será denotada por $\\overline{Y}_j$, que neste exemplo são: $Y_1 = 20.64$ (grupo `A`), $Y_2 = 28.68$ (grupo `B`) e $Y_3 = 12.18$ (grupo `C`).\n\n+ Vamos denotar por $\\overline{\\overline{Y}}$ a **Grande Média**, isto é, a média geral de todas as observações independente do grupo de origem.\n\n$$\\overline{\\overline{Y}} = \\sum_{j = 1}^{k}\\sum_{i = 1}^{n}\\frac{Y_{ij}}{N} = \\frac{\\overline{Y_1} + \\overline{Y_2} + \\overline{Y_3}}{3} = 20.5$$\n\n:::\n\nPodemos agora observar estes elementos no gráfico de dispersão.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\nEm seguida, precisamos calcular $3$ quantias, a **Soma dos Quadrados Totais** ($SQ_{Total}$), a **Soma dos Quadrados dos Tratamentos** $SQ_{Trat}$ e a **Soma dos Quadrados dos Resíduos** $SQ_{Res}$.\n\ni. **Soma dos Quadrados Totais** $SQ_{Total}$: mede as diferenças entre $Y_{ij}$ e $\\overline{\\overline{Y}}$. Temos nesta expressão o somatório dos desvios ao quadrado de todas as observações com relação à grand, fig.align='center', fig.width=8, fig.height=4e média **independente** do grupo de origem de cada observação.\n\n$$SQ_{Total} = \\sum_{j = 1}^{k}\\sum_{i = 1}^{n}(Y_{ij} - \\overline{\\overline{Y}})^2$$\n\n\nii. **Soma dos Quadrados dos Tratamentos** $SQ_{Trat}$: mede as diferenças entre as **médias dos tratamentos** $\\overline{Y}_j$ e $\\overline{\\overline{Y}}$, sendo portanto os desvios ao quadrado da média de cada tratamento subtraída da grande média. $SQ_{Trat}$ também é chamada de soma dos quadrados **entre grupos** ou **entre tratamentos**\n\n$$SQ_{Trat} = \\sum_{j = 1}^{k}\\sum_{i = 1}^{n_{j}}(\\overline{Y}_{j} - \\overline{\\overline{Y}})^2 = \\sum_{j = 1}^{k}n_{j}(\\overline{Y}_{j} - \\overline{\\overline{Y}})^2$$\n\niii. **Soma dos Quadrados dos Resíduos** $SQ_{Res}$: mede as diferenças entre cada observação $Y_{ij}$ e a média de seu próprio grupo $\\overline{Y}_{j}$. $SQ_{Res}$ também é chamada de soma dos quadrados **dentro dos grupos** ou **dentro dos tratamentos**\n\n$$SQ_{Res} = \\sum_{j = 1}^{k}\\sum_{i = 1}^{n_{j}}(Y_{ij} - \\overline{Y}_{j})^2$$\n\n:::{.callout-note}\n\n## A característica aditiva das somas dos quadrados\n\nA partição da soma dos quadrados consiste em decompor a **variação total** do experimento em uma parcela atribuída à variação **entre tratamentos** e outra parcela da variação **dentro dos tratamentos**. Isto é possível pois as somas dos quadrados definidas acima podem ser expressas de forma aditiva como:\n\n$$SQ_{Total} = SQ_{Trat} + SQ_{Res}$$\n\nDeste modo, é possível demostrar que:\n\n$\\sum_{j = 1}^{k}\\sum_{i = 1}^{n}(Y_{ij} - \\overline{\\overline{Y}})^2 = \\sum_{j = 1}^{k}n_{j}(Y_{j} - \\overline{\\overline{Y}})^2 + \\sum_{j = 1}^{k}\\sum_{i = 1}^{n}(Y_{ij} - \\overline{Y}_{j})^2$\n\n:::\n\n## Medindo a associação entre $Y$ e $X$\n\nA característica aditiva das somas dos quadrados pode ser utilizada para mensurar o grau de dependência de $Y_{ij}$ com respeito aos diferentes tratamentos. Compare as duas figuras abaixo:\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](biquantquali_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\nA soma dos quadrados dentro dos grupos é a mesma nas duas figuras ($SQ_{Res} = 362.6$). No entanto, na figura da esquerda, em que as médias dos tratamentos são similares (e consequentemente próximas à grande média), a soma dos quadrados entre os tratamentos é muito menor ($SQ_{Trat}^{esquerda} = 15.8$) que na figura da direita, em que as médias dos tratamentos estão distantes entre si ($SQ_{Trat}^{direita} = 680.8$). É desta forma que a partição das somas dos quadrados nos permite diferenciar situações em que: i - a média dos grupos **depende** dos níveis do tratamento (figura da direita); de situações em que ii - a média **não depende** dos níveis do tratamento (figura da esquerda). \n\n### O coeficiente de determinação ($R^2$)\n\nPodemos expressar a relação entre $SQ_{Trat}$ e $SQ_{Total}$ pela expressão:\n\n___\n\n$$R^2 = \\frac{SQ_{Trat}}{SQ_{Trat} + SQ_{Res}} = \\frac{SQ_{Trat}}{SQ_{Total}}$$\n\n___\n\n$R^2$ é chamado de **coeficiente de determinação** e varia entre $0$ e $1$. Se $R^2 = 0$ toda a variação em $Y$ é causada por $SQ_{Res}$ ($\\overline{\\overline{Y}} = \\overline{Y}_1 = \\overline{Y}_2 = \\cdots = \\overline{Y}_k$). À medida que as médias dos tratamentos se distanciam umas das outras, $R^2$ se aproxima de $1$ pois a maior parte da variação em $Y$ é causada por $SQ_{Trat}$.\n\n\n## Partição das Soma dos Quadrados no ambiente R\n\nVoltando ao conjundo de dados `medley.csv`, uma forma de obter os somatórios dos quadrados no R é utilizando a função `aov` (mas veja também a função `lm`).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov(DIVERSITY ~ ZINC, data = medley)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = DIVERSITY ~ ZINC, data = medley)\n\nTerms:\n                    ZINC Residuals\nSum of Squares  2.566612  6.516411\nDeg. of Freedom        3        30\n\nResidual standard error: 0.4660619\nEstimated effects may be unbalanced\n```\n\n\n:::\n:::\n\n\n\n\nO resultado retorna a soma dos quadrados dos tratamentos (neste caso a coluna `ZINC`) e dos resíduos (coluna `Residuals`). Como o $SQ_{Total}$ é simplesmente a soma dos dois anteriores, podemos obtê-lo facilmente:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsq = aov(DIVERSITY ~ ZINC, data = medley)\nSQTrat = anova(sq)$`Sum Sq`[1]\nSQRes = anova(sq)$`Sum Sq`[2]\nSQTotal = SQTrat + SQRes\n\nSQTotal\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.083024\n```\n\n\n:::\n:::\n\n\n\n\nPor fim, o $R^2$ pode ser calculado por:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nR2 = SQTrat / SQTotal\nR2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2825725\n```\n\n\n:::\n:::\n",
    "supporting": [
      "biquantquali_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}