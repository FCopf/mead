{
  "hash": "62e4830489e7ea45310cb42e00dc5e19",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regressão linear simples\"\ndescription: \"Introdução à regressão linear simples, incluindo ANOVA da regressão, coeficiente de determinação e diagnósticos básicos.\"\nCategories: [\n          \"Regressão linear\",\n          \"Estatística\"\n        ]\n\nimage: \"images/regressao-linear-simples.jpg\"\nexecute:\n  echo: true\n  warning: false\n  include: true\n  message: false\n---\n\n\n\n\n:::{.callout-tip collapse=\"true\"}\n## Pacotes, funções e base de dados utilizadas\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(knitr)\n```\n:::\n\n\n\n\n:::\n\nUm modelo de regressão linear nos permite verificar se há uma relação funcional entre variáveis quantitativas. Nesta relação, uma variável é denominada **dependente** (ou **variável resposta** - $Y$) e as demais **independentes** (ou **variáveis preditoras** - $X$). Portanto, ao ajustar um modelo de regressão linear, estamos assumindo que existe uma relação estatística de **dependencia** de $Y$ como *função* das variáveis preditoras em $X$. No modelo de regressão linear **simples** temos somente **uma** variável preditora e sua relação funcional com $Y$ é dada por:\n\n$$Y_i = \\beta_0 + \\beta_1X_i + \\epsilon_i$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nst <- read_csv(\"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/HubbardBrook_wide.csv\") |>\n    rename(FlowD = WS2_Flow_Defosrested, FlowR = WS3_Flow_reference, \n           RainD = WS2_precipitation, RainR = WS3_precipitation) |>\n    mutate(FlowD = FlowD / 100, FlowR = FlowR / 100,\n           RainD = RainD / 10, RainR = RainR / 10) |>\n    (\\(df) df[-31, ])()\n```\n:::\n\n\n\n\n\nConsidere novamente os dados sobre pluviosidade anual e vazão em uma bacia hidrográfica americada, medidos entre os anos de 1958 e 1987 (disponível em: [tiee.esa.org](https://tiee.esa.org/vol/v1/data_sets/hubbard/hubbard_overview.html)). Vamos avaliar a relação entre a vazão na bacia e os volumes de chuva.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vwomojaqvl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vwomojaqvl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vwomojaqvl thead, #vwomojaqvl tbody, #vwomojaqvl tfoot, #vwomojaqvl tr, #vwomojaqvl td, #vwomojaqvl th {\n  border-style: none;\n}\n\n#vwomojaqvl p {\n  margin: 0;\n  padding: 0;\n}\n\n#vwomojaqvl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vwomojaqvl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vwomojaqvl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vwomojaqvl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vwomojaqvl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vwomojaqvl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vwomojaqvl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vwomojaqvl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vwomojaqvl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vwomojaqvl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vwomojaqvl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vwomojaqvl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vwomojaqvl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vwomojaqvl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vwomojaqvl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vwomojaqvl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vwomojaqvl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vwomojaqvl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vwomojaqvl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vwomojaqvl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vwomojaqvl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vwomojaqvl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vwomojaqvl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vwomojaqvl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vwomojaqvl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vwomojaqvl .gt_left {\n  text-align: left;\n}\n\n#vwomojaqvl .gt_center {\n  text-align: center;\n}\n\n#vwomojaqvl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vwomojaqvl .gt_font_normal {\n  font-weight: normal;\n}\n\n#vwomojaqvl .gt_font_bold {\n  font-weight: bold;\n}\n\n#vwomojaqvl .gt_font_italic {\n  font-style: italic;\n}\n\n#vwomojaqvl .gt_super {\n  font-size: 65%;\n}\n\n#vwomojaqvl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vwomojaqvl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vwomojaqvl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vwomojaqvl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vwomojaqvl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vwomojaqvl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vwomojaqvl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vwomojaqvl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vwomojaqvl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Year\">Year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"FlowD\">FlowD</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"FlowR\">FlowR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diference\">Diference</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"RainD\">RainD</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"RainR\">RainR</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1958</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">645.15</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">567.36</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">7779</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1167.5</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1161.0</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1959</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1012.05</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">918.23</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">9382</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1482.6</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1479.1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1960</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">825.22</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">752.06</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">7316</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1321.3</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1325.3</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1961</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">470.05</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">436.25</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">3380</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">979.7</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">978.9</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1962</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">777.31</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">699.29</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">7802</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1232.2</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1230.6</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1963</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">773.64</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">662.58</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">11106</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1138.6</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1151.7</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1964</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">712.15</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">630.45</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">8170</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1175.4</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1175.2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1965</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">598.85</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">546.69</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">5216</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1115.2</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1120.6</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1966</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1189.34</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">726.73</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">46261</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1222.3</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1223.2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1967</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1131.85</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">780.76</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">35109</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1315.1</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1296.8</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1968</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1056.54</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">762.84</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">29370</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1268.2</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1285.2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1969</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1347.61</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">998.68</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">34893</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1368.5</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1403.5</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1970</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">905.47</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">697.53</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">20794</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1184.1</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1201.5</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1971</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">800.56</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">676.19</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">12437</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1164.2</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1173.4</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1972</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1005.90</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">885.91</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">11999</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1431.3</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1424.0</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1973</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1585.73</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">1396.43</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">18930</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1804.0</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1792.8</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1974</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">998.20</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">890.45</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">10775</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1406.8</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1408.9</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1975</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1086.33</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">939.52</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">14681</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1422.4</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1448.6</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1976</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1142.59</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">1022.06</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">12053</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1511.4</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1516.0</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1977</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">966.25</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">843.75</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">12250</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1382.7</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1388.2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1978</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">722.04</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">613.79</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">10825</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1087.9</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1085.7</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1979</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1136.17</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">1036.93</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">9924</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1417.0</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1432.7</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1980</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">585.22</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">548.28</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">3694</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1087.9</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1101.1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1981</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1129.09</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">1093.91</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">3518</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1631.5</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1664.9</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1982</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">802.73</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">756.12</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">4661</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1088.2</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1114.4</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1983</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">917.13</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">889.35</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">2778</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1436.6</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1451.8</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1984</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">1000.54</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">970.65</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">2989</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1396.8</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1403.5</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1985</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">634.76</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">627.84</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">692</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1128.4</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1137.2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1986</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">987.99</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">960.94</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">2705</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1364.0</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1372.3</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">1987</td>\n<td headers=\"FlowD\" class=\"gt_row gt_right\">790.47</td>\n<td headers=\"FlowR\" class=\"gt_row gt_right\">797.09</td>\n<td headers=\"Diference\" class=\"gt_row gt_right\">-662</td>\n<td headers=\"RainD\" class=\"gt_row gt_right\">1222.1</td>\n<td headers=\"RainR\" class=\"gt_row gt_right\">1234.6</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nÉ razoável supor que em anos de mais chuva, seriam esperadas maiores vazões e que anos mais secos resultassem menores volumes de vazão. Para verificar esta suposição vamos fazer um gráfico de dispersão entre vazão e chuva.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\nO gráfico sugere que a suposição faz sentido. Volumes baixos de chuva estão associados a volumes baixos de vazão e vice versa. O gráfico sugrere ainda que a relação funcional é **linear**. Nestas condições, faz sentido tentar modelar a relação entre estas variáveis por meio de um modelo de regressão linear simples.\n\nAo ajustar um modelo de regressão, vemos que a linha em azul é a que melhor descreve a relação linear entre as variáveis. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\nEsta linha nos permite obter uma estimativa sobre a vazão esperada ($Y$) para qualquer **dado** volume de chuva ($X$). Neste exemplo, a equação que melhor associa vazão e chuva é:\n\n$$Y_i = -571.98 + 1.05 X_i$$\n\nO valor de $\\beta_1 = 1.05$ nos diz que para um aumento de 1 mm/area/ano de chuva, a vazão aumentará 1.05 mm/area/ano. $\\beta_1$ é conhecido como **coeficiente de inclinação da reta** e nos fornece magnitude da variação em $Y$ para um aumento de **1 unidade** em $X$.\n\nEsta equação prevê por exemplo, que para um volume de chuva igual a 1400  mm/area/ano a vazão na bacia será de 898 mm/area/ano. *Faça as contas para conferir*.\n\n$$898.02 = -571.98 + 1.05 \\times 1400$$\n\nA reta descreve portanto os valores **preditos** de vazão para cada nível de chuva. \n\n## Modelo geral de regressão\n\nA estrutura de um modelo de regressão é dada por:\n\n$$Y_i = f(X_i, \\beta) + \\epsilon_i$$\n\nonde $f(X_i, \\beta)$ representa a parte **determinística** e $\\epsilon$ a parte **estocástica**. O sulfixo *i* nos diz que esta expressão é dada para **cada par de observação** $(Y,X)$.\n\n### Porção determinística\n\nA porção determinística é um modelo matemático que descreve a relação funcional entre $X$ e $Y$. Os parâmetros $\\beta$'s determinam a intensidade do efeito de $X$ sobre $Y$. Na regressão linear **simples** temos somente uma variável $X$, e a relação funcional é dada pela **equação da reta**. No modelo de regressão linear **múltipla** existe mais de uma variável $X$. Finalmente, nos modelos de regressão **não-lineares** a relação funcional pode ser representada por outros modelos matemáticos (ex. função potência $Y = \\beta_0X^{\\beta_1}$).\n\nNa regressão linear simples, o parâmetro $\\beta_1$ é geralmente o de maior interesse. Este parâmetro nos dirá se a relação será crescente ($\\beta_1 > 0$), decrescente ($\\beta_1 < 0$) ou nula ($\\beta_1 = 0$). $\\beta_0$ é o $\\textbf{intercepto}$ e expressa o ponto em $Y$ em que a reta cruza o eixo das ordenadas.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n### Porção estocástica\n\nA porção estocástica, é representada pelo **resíduo** ou **erro**. A cada observação $Y_i$ está associado um valor de resíduo correspondente ($\\epsilon_i$), dado pela distância vertical entre $Y_i$ e o valor predito $\\hat{Y_i}$ sobre a reta de regressão. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\nNo modelo de regressão linear que veremos aqui, os resídos são uma **variável aleatória** prevenientes de uma distribuição normal de probabilidades com média $\\mu = 0$ e variância $\\sigma^2$ constante ao longo da reta de regressão, $N(0, \\sigma^2)$.\n\n::: {#fig-regre2}\n\n![](images/Regre2.png)\n\nResíduo normalmente distribuído ao longo da reta de regressão.\n\n:::\n\n## Ajuste dos dados ao modelo de regressão\n\nO ajuste de dados observados a um modelo de regressão requer a obtenção de estimativas para $\\beta_0$, $\\beta_1$ e $\\sigma^2$, denotadas respectivamente por $\\hat{\\beta_0}$, $\\hat{\\beta_1}$ e $\\hat{\\sigma}^2$. Note que o símbolo $\\hat{}$ significa que estamos falando de **estimativas** obtidas a partir de dados amostrais e não dos parâmetros populacionais.\n\nAo obter estas estimativas, podemos encontrar valores **ajustados** de $Y$ para um dados valor de $X$. Os valores ajustados de $Y$ são denotados por $\\hat{Y}$.\n\n$$\\hat{Y_i} = \\hat{\\beta_0} + \\hat{\\beta_1}X_i$$\n\n### Método dos mínimos quadrados\n\nO **Método dos Mínimos Quadrados** ($MMQ$) é uma das formas disponíveis para calcularmos $\\hat{\\beta_0}$, $\\hat{\\beta_1}$ e $\\hat{\\sigma}^2$. O $MMQ$ envolve encontrar a combinação de $\\hat{\\beta_0}$ e $\\hat{\\beta_1}$ que minimiza a **Soma dos Quadrados dos Resíduos** ($SQ_{Resíduo}$), ou seja, que minimizam a quantia:\n\n$$SQ_{Resíduo} = \\sum{(Y_i-\\hat{Y_ i})^2} = \\sum{(Y_i-(\\hat{\\beta_0} + \\hat{\\beta_1}X_i))^2}$$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\nNas figuras acima, a linha da esquerda ($SQ_{Resíduo} = \\sum{\\epsilon_i^2} = 37$) está claramente melhor ajustada à nuvem de pontos, o que se expressa em um menor somatório dos quadrados dos resíduos ($SQ_{Resíduo} = \\sum{\\epsilon_i^2} = 37$) quando comparado com o ajuste da figura à direita ($SQ_{Resíduo} = \\sum{\\epsilon_i^2} = 145$).\n\n### Variâncias, covariâncias e coeficientes da regressão\n\nPara estimarmos os coeficientes da regressão $\\beta_0$ e $\\beta_1$ devemos retomar o conceito de **variância amostral** e introduzir o conceito de **covariância amostral**.\n\nA variância amostral de $Y$ por exemplo, pode ser obtida subtraindo cada observação em $Y$ de sua média ($\\overline{Y}$) e elevando esta subtração ao quadrado $(Y_i - \\overline{Y})^2$. Ao somar para todos os valores de $Y_i$ teremos o **somatório dos quadrados de $Y$** ($SQ_Y$). \n\n$$SQ_Y = \\sum_{i-1}^{n} (Y_i - \\overline{Y})^2 = \\sum_{i-1}^{n}(Y_i - \\overline{Y}) (Y_i - \\overline{Y})$$\n\nDividindo $SQ_Y$ por $n-1$ teremos a **variância amostral de $Y$** ($s^2_Y$).\n\n$$s^2_Y = \\frac{\\sum_{i-1}^{n} (Y_i - \\overline{Y})^2}{n-1}$$\n\nAdotando o mesmo procedimento para $X$, podemos calcular o **somatório dos quadrados de $X$** ($SQ_X$).\n\n$$SQ_X = \\sum_{i-1}^{n} (X_i - \\overline{X})^2 = \\sum_{i-1}^{n}(X_i - \\overline{X}) (X_i - \\overline{X})$$\n\ne a **variância amostral de $X$** ($s^2_X$).\n\n$$s^2_X = \\frac{\\sum_{i-1}^{n} (X_i - \\overline{X})^2}{n-1}$$\n\nCombinando as duas ideias, teremos o **produto cruzado de $Y$ e $X$** ($SQ_{YX}$)\n\n$$SQ_{YX} = \\sum_{i-1}^{n}(Y_i - \\overline{Y}) (X_i - \\overline{X})$$\n\ne a **covariância amostral entre $Y$ e $X$** ($s_{YX}$).\n\n$$s_{YX} = \\frac{\\sum_{i-1}^{n}(Y_i - \\overline{Y}) (X_i - \\overline{X})}{n-1}$$\n\nO estimador $\\hat{\\beta_1}$ nada mais é que a covariância entre $Y$ e $X$ **padronizada** pela variância de $X$.\n\n$$\\hat{\\beta_1} = \\frac{s_{YX}}{s^2_X} = \\frac{\\frac{SQ_{XY}}{n-1}}{\\frac{SQ_X}{n-1}} = \\frac{SQ_{XY}}{SQ_X} = \\frac{\\sum{(Y_i - \\overline{Y})(X_i - \\overline{X})}}{\\sum{(X_i - \\overline{X})^2}}$$\n\n$$\\hat{\\beta_1} = \\frac{\\sum{(Y_i - \\overline{Y})(X_i - \\overline{X})}}{\\sum{(X_i - \\overline{X})^2}}$$\n\nApós encontrar $\\hat{\\beta_1}$, podemos calcular $\\hat{\\beta_0}$ sabendo que a melhor reta de regressão passará **necessariamente** pelo ponto médio de $X$ e de $Y$. Deste modo temos:\n\n$$\\hat{\\beta_0} = \\overline{Y} - \\hat{\\beta_1}\\overline{X}$$\n\nCalculados $\\hat{\\beta_1}$ e $\\hat{\\beta_0}$, podemos encontrar os valores ajustados de $Y$ para cada valor de $X$ que serão utilizados para construir a reta de regressão. $\\hat{Y_i}$ será dado por:\n\n$$\\hat{Y_i} = \\hat{\\beta_0} + \\hat{\\beta_1}X_i$$\n\nPor fim, a variância residual $s^2$ é dada por:\n\n$$s^2 = QM_{Resíduo} = \\frac{SQ_{Resíduo}}{n-2} = \\frac{\\sum{(Y_i-\\hat{Y_ i})^2}}{n-2}$$\n\n### Exemplo de ajuste ao modelo de regressão\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrk = read_csv('https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/RIKZ.csv')\nrks = rk |> \n  (\\(df) df[seq(3,43,by = 5),])()\n```\n:::\n\n\n\n\nConsidere a tabela abaixo com os dados de riqueza da macro-fauna praial (número de espécies) e de um índice de exposição às ondas (NAP). Os dados foram obtidos em 2002 na costa da Holanda em nove praias [@zuur2009mixed]. Valores negativos de NAP se referem a locais mais expostos e valores positivos a locais menos expostos à ação das ondas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrks |> \n  select(Richness, NAP) |> \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mibrwmclla\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mibrwmclla table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mibrwmclla thead, #mibrwmclla tbody, #mibrwmclla tfoot, #mibrwmclla tr, #mibrwmclla td, #mibrwmclla th {\n  border-style: none;\n}\n\n#mibrwmclla p {\n  margin: 0;\n  padding: 0;\n}\n\n#mibrwmclla .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mibrwmclla .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mibrwmclla .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mibrwmclla .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mibrwmclla .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mibrwmclla .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mibrwmclla .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mibrwmclla .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mibrwmclla .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mibrwmclla .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mibrwmclla .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mibrwmclla .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mibrwmclla .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mibrwmclla .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mibrwmclla .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mibrwmclla .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mibrwmclla .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mibrwmclla .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mibrwmclla .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mibrwmclla .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mibrwmclla .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mibrwmclla .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mibrwmclla .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mibrwmclla .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mibrwmclla .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mibrwmclla .gt_left {\n  text-align: left;\n}\n\n#mibrwmclla .gt_center {\n  text-align: center;\n}\n\n#mibrwmclla .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mibrwmclla .gt_font_normal {\n  font-weight: normal;\n}\n\n#mibrwmclla .gt_font_bold {\n  font-weight: bold;\n}\n\n#mibrwmclla .gt_font_italic {\n  font-style: italic;\n}\n\n#mibrwmclla .gt_super {\n  font-size: 65%;\n}\n\n#mibrwmclla .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mibrwmclla .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mibrwmclla .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mibrwmclla .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mibrwmclla .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mibrwmclla .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mibrwmclla .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mibrwmclla .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mibrwmclla div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Richness\">Richness</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"NAP\">NAP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">13</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">-1.336</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">8</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">0.635</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">4</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">-0.201</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">3</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">0.460</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">6</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">0.729</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">1</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">2.222</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">1</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">1.375</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">7</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">-1.005</td></tr>\n    <tr><td headers=\"Richness\" class=\"gt_row gt_right\">3</td>\n<td headers=\"NAP\" class=\"gt_row gt_right\">-0.002</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nO gráfico de dispersão sugere uma relação negativa e possivelmente linear, em que a riqueza de espécies diminui com o aumento no grau de exposição. Vamos ajustar um modelo de regressão a estes pontos calculando $\\hat{\\beta_0}$, $\\hat{\\beta_1}$ e $\\hat{\\sigma}^2$.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\nOs passos intermediários envolvem o cálculo do somatórios dos quadrados de X: \n\n$$SQ_X = \\sum{(X_i - \\overline{X})^2}$$\n\nde Y: \n\n$$SQ_Y = \\sum{(Y_i - \\overline{Y})^2}$$\n\ne do somatório dos produtos cruzados de X e Y: \n\n$$SQ_{XY} = \\sum{(X_i - \\overline{X}) (Y_i - \\overline{Y})}$$\n\nEstes passos são descritos na tabela a seguir.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| Richness|   NAP| $(X_i - \\overline{X})$| $(Y_i - \\overline{Y})$| $(X_i - \\overline{X})^2$| $(Y_i - \\overline{Y})^2$| $(X_i - \\overline{X})(Y_i - \\overline{Y})$|\n|--------:|-----:|----------------------:|----------------------:|------------------------:|------------------------:|------------------------------------------:|\n|       13| -1.34|                  -1.66|                   7.89|                     2.74|                    62.23|                                     -13.06|\n|        8|  0.64|                   0.32|                   2.89|                     0.10|                     8.35|                                       0.91|\n|        4| -0.20|                  -0.52|                  -1.11|                     0.27|                     1.23|                                       0.58|\n|        3|  0.46|                   0.14|                  -2.11|                     0.02|                     4.46|                                      -0.30|\n|        6|  0.73|                   0.41|                   0.89|                     0.17|                     0.79|                                       0.36|\n|        1|  2.22|                   1.90|                  -4.11|                     3.62|                    16.90|                                      -7.82|\n|        1|  1.38|                   1.06|                  -4.11|                     1.11|                    16.90|                                      -4.34|\n|        7| -1.00|                  -1.32|                   1.89|                     1.75|                     3.57|                                      -2.50|\n|        3|  0.00|                  -0.32|                  -2.11|                     0.10|                     4.46|                                       0.68|\n\n\n:::\n:::\n\n\n\n\nApós os cálculos, os valores estimados são:\n\n$$\\hat{\\beta_1} = \\frac{\\sum{(X_i - \\overline{X})(Y_i - \\overline{Y})}}{\\sum{(X_i - \\overline{X})^2}} = \\frac{-25.49}{9.88} = -2.58$$\n\n$$\\hat{\\beta_0} = \\overline{Y} - \\hat{\\beta_1}\\overline{X} = 5.11 -2.58 \\times 0.32 = 5.94$$\n\n$$\\hat{\\sigma}^2 = QM_{Resíduo} = \\frac{SQ_{Resíduo}}{n-2} = \\frac{\\sum{(Y_i-\\hat{Y_ i})^2}}{n-2} = \\frac{53.11}{7} = 7.59$$\n\nDe modo que a melhor reta de regressão é dada por:\n\n$$Richness = 5.94 -2.58 \\times NAP$$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n## Testes de hipóteses na regressão linear simples\n\nAté o momento, apresentamos uma discussão sobre o método para calcular os estimadores $\\hat{\\beta_0}$, $\\hat{\\beta_1}$ e $\\hat{\\sigma}$. Entretanto, como nossas observações provêm de **amostras**, estas estimativas estão sujeitas à variação inerente às observações de que dispomos e certamente não serão iguais ao valor da **população estatística**. Devemos portanto, entender quais evidências estes estimadores nos fornecem para a existência de um efeito de $X$ sobre $Y$, ou seja, para rejeitarmos a hipótese nula em favor de $H_A$.\n\n### Teste sobre $\\beta_1$\n\nNa regressão linear simples, o efeito de $X$ sobre $Y$ depende do valor de $\\beta_1$\n\n$Y_i = \\beta + \\beta_1X_i + \\epsilon_i$\n\nA não existência de um efeito implica em $\\beta_1 = 0$ e consequentemente:\n\n$Y_i = \\beta_0 + 0 \\times X_i + \\epsilon_i$ $\\rightarrow$ $Y = \\beta_0 + \\epsilon_i$\n\nPortanto, as hipóteses nula e alternativa seriam:\n\n$H_0: \\beta_1 = 0$\n\n$H_A: \\beta_1 \\ne 0$\n\nSegundo $H_0$, a inclinação da reta $populacional$ não é diferente de zero e o valor estimado $\\hat{\\beta_1}$ ocorreu puramente ao acaso, como efeito da variação amostral. Para testar esta hipótese, utilizamos a **distribuição de t** de modo que:\n\n$$t = \\frac{\\hat{\\beta_1} - \\beta_1}{s_{\\hat{\\beta_1}}}$$\n\nComo segundo $H_0$, $\\beta_1  = 0$ a expressão fica:\n\n$$t = \\frac{\\hat{\\beta_1} - 0}{s_{\\hat{\\beta_1}}} = \\frac{\\hat{\\beta_1}}{s_{\\hat{\\beta_1}}}$$\n\n$s_{\\hat{\\beta_1}}$ é o **erro padrão** de $\\beta_1$ calculado por:\n\n$$s_{\\hat{\\beta_1}} = \\sqrt{\\frac{\\hat{\\sigma}^2}{\\sum{(X_i-\\overline{X})^2}}}$$\n\nNo exemplo sobre a fauna praial estamos interessados em testar a hipótese de que a riqueza de espécies esteja associada ao grau de exposição às ondas. Em regressão linear, esta hipótese pode ser expressa por:\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n$$t = \\frac{\\hat{\\beta_1}}{s_{\\hat{\\beta_1}}} = \\frac{-2.58}{0.88} = -2.944$$\n\nQue na distribuição de t fica:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\nSe nosso nível de significancia $\\alpha = 0.05$, então a probabilidade $p = 0.011 + 0.011 = 0.022$ indica que devemos **rejeitar** $H_0$ e aceitar que **existe** uma relação entre Riqueza de espécies e NAP.\n\n### Análise de variância da regressão\n\nComo já dizemos, a estrutura de um modelo de regressão é dada por um componente sistemático expresso como função de $X$ ($\\beta_0 + \\beta_1X_i$) e um componente aleatório expresso pelos resíduos do modelo ($\\epsilon_i$). A variação total em $Y$ no modelo de regressão portanto, pode ser atribuída a ambos os efeitos de $X$ e do resíduo. Estas quantias de variação podem mensuradas pelos somatório dos quadrados abaixo.\n\nSoma dos quadrados **totais**:\n\n$SQ_Y = \\sum{(Y_i - \\overline{Y})^2}$\n\nSoma dos quadrados da **regressão**:\n\n$SQ_{Regressão}= \\sum{(\\hat{Y_i} - \\overline{Y})^2}$\n\nE soma dos quadrados do **resíduo**:\n\n$SQ_{Resíduo}= \\sum{(Y_i - \\hat{Y_i})^2}$\n\nPode-se mostrar ainda que vale a expressão:\n\n$$SQ_Y = SQ_{Regressão} + SQ_{Resíduo}$$\nA decomposição destas quantias é conhecida **partição das somas dos quadrados** e nos permitem comparar a influência de $X$ com a influência do puro acaso sobre a variabilidade em $Y$. Se todos os pontos estiverem perfeitamente sobre a reta, então toda a variação em $Y$ seria atribuída à influência de $X$. Por outro lado, à medida que aumenta a distância média dos pontos acima e abaixo da curva, aumenta a parcela atribuída ao **acaso**.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n\n\nEstes **componentes de variação** podem ser organizados em uma Tabela de **Análise de Variância (ANOVA)**. $n$ se refere ao número de amostras.\n\n|Fonte de variação |SQ               |gl                |QM                                                       |F                                     |p | \n| :--- | :------:| :------:| :------:| :------:| :------:|\n|Regressão         |$SQ_{Regressão}$ |$gl_{Regressão}$  |$QM_{Regressão} = \\frac{SQ_{Regressão}}{gl_{Regressão}}$ |$\\frac{QM_{Regressão}}{QM_{Resíduo}}$ |Probabilidade associada à cauda da distribuição F| \n|Resíduo           |$SQ_{Resíduo}$   |$gl_{Resíduo}$    |$QM_{Resíduo} = \\frac{SQ_{Resíduo}}{gl_{Resíduo}}$       |                                      | | \n|Total             |$SQ_{Y}$         |$gl_{Y}$          |$QM_{Y} = \\frac{SQ_{Y}}{gl_{Y}}$                         |                                      | | \n\n\nAs coluna $gl$ se refer aos graus de liberdade nos modelo de regressão, a semelhança do que discutimos para o teste t de Student. A coluna **QM** (**Quadrado médio**) apresenta os estimadores de variância da regressão ($QM_{Regressão}$), do resíduo ($QM_{Resíduo}$) e total ($QM_{Y}$). \n\n#### A distribuição F\n\nO valor de $F$ na tabela se refere a **distribuição de probabilidade F**. Esta distribuição de probabilidades é esperada para a razão entre duas variâncias amostrais. No caso da regressão linear, estas são a **variância da regressão** ($QM_{Regressão}$ no numerador) e a **variância residual** ($QM_{Resíduo}$ no denominador). Diferente da distribuiçao t, a distribuição F tem um formato assimétrico, sendo que o grau de assimetria depende dos graus de liberdade do numerador e do denominador. O valor de $p$ na tabela se refere à área sob a distribuição F, **acima** do valor de $F$ calculado. Na ANOVA da regressão, um valor de $p < \\alpha$ nos leva a rejeitar a hipótese nula e assumir que a variável $X$ **exerce** algum efeito sobre $Y$.\n\n> O símbolo $F$ foi dado em homenagem a Ronald Aylmer Fisher o estatístico e geneticista Britânico do início do séc. XX, que entre inúmeras outras contribuições, desenvolveu a Análise de Variância. Fisher é descrito como *\"a genius who almost single-handedly created the foundations for modern statistical science\"* [@halt1998history] e como *\"the single most important figure in 20th century statistics\"* [@efron1998r]. Ver [Ronald Aylmer Fisher](https://en.wikipedia.org/wiki/Ronald_Fisher).\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\nOs resultados da ANOVA para os dados da fauna praial nos dá os seguintes valores. *Confira os cálculos*.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Fonte de variação |     SQ| gl|    QM|    F|     p|\n|:-----------------|------:|--:|-----:|----:|-----:|\n|Regressão         |  65.68|  1| 65.68| 8.64| 0.022|\n|Resíduo           |  53.21|  7|  7.60|   NA|    NA|\n|Total             | 118.89|  8| 14.86|   NA|    NA|\n\n\n:::\n:::\n\n\n\n\nO valor de $p = 0.022$ **abaixo** do nível de significância $\\alpha = 0.05$, nos leva a rejeitar a hipótese nula em favor da alternativa, concluindo que o índice de exposição às ondas **interfere** sobre a riqueza da macro-fauna. O valor de $p$ foi identico ao obtido no teste de hipóteses de $\\beta_1$. No modelo de regressão linear **simples** isto é necessariamente verdadeiro, pois toda a variação associada à regressão é devida ao efeito do coeficiente $\\beta_1$. Por outro lado, nos modelos de regressão **múltipla**, em que temos:\n\n$$Y_i = \\beta_0 + \\beta_1X_{i1} + \\beta_1X_{i2} + \\cdots + \\beta_mX_{im} + \\epsilon_i$$\n\nesta relação não é mais observada, pois existem múltiplos coeficientes agindo sobre a variação em $Y$.\n\n## Coeficiente de determinação $R^2$\n\nUma vez que toda a variação observada em Y pode ser alocada aos efeitos da **reta de regressão** e e do **resíduo** podemos fazer a seguinte questão:\n\n> Qual parcela da variação na Riqueza é explicada **exclusivamente** pelo modelo de regressão?\n\nEsta pergunta pode ser respondida calculando o que denominamos de **coeficiente de determinção** ou simplesmente $R^2$:\n\n$$R^2 = \\frac{SQ_{Regressão}}{SQ_Y} = 1 - \\frac{SQ_{Resíduo}}{SQ_Y}$$\n\n\nO valor de $SQ_{Regressão}$ mede a variação **explicada exclusivamente** pela regressão, $SQ_{Resíduo}$ a **variação residual** e $SQ_Y$ mede a **variação total** em $Y$. Ao dividir $SQ_{Resíduo}$ por $SQ_Y$, o $r^2$ nos informa sobre qual a **fração** da variação total é explicada somente pela reta de regressão.\n\nNpo exemplo da fauna praial:\n\n$$R^2 = 1 - \\frac{53.11}{118.89} = 0.5533$$\n\nO que significa que aproximadamente 55.33\\% da variação na riqueza é explicada pela variação no grau de exposição às ondas (NAP). Não sabemos a que se deve o restante da variação e, no contexto do modelo de regressão, assumimos ser uma variação aleatória inerente a cada observação ($\\epsilon_i$). Esta variação aleatória, como dito, segue uma distribuição normal com ponto central sobre a reta e variância data por $\\sigma^2$. Este pressuposto é fundamental para a discussão do próximo ponto a respeito do **intervalo de confiança de $Y$**\n\n## Intervalo de confiança de $Y$\n\nComo nem todos os pontos caem perfeitamente sobre a reta, seria interessante que pudéssemos obter um intervalo de confiança de $Y$ para um dado valor de $X$. A amplitude deste intervalo irá depender da **variância dos valores ajustados** ($s^2_{Y|X}$) de $Y$, calculada por:\n\n$$s^2_{Y|X} = s^2(\\frac{1}{n} + \\frac{(X_i-\\overline{X})^2}{SQ_X})$$\n\ndo modo que: \n\n$$s_{Y|X} = \\sqrt{s^2(\\frac{1}{n} + \\frac{(X_i-\\overline{X})^2}{SQ_X})}$$\n\nNote pela expressão acima que o $s_{Y|X}$ diminui quanto:\n\n1. a variância residual $s^2$ diminui;\n2. o tamanho amostral $n$ aumenta. \n3. o dado valor de $X_i$ está próximo à média, pois neste caso $(X_i-\\overline{X})$ diminui.\n\nEncontrado $s_{Y|X}$, o intervalo de confiança de $Y$ é dado por:\n\n$$IC_{Y} = \\hat{Y}\\pm t_{(\\alpha, n-2)} \\times s_{Y|X}$$\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nPara os dados da macrofauna, vamos exemplificar o cálculo de $IC_{95\\%}$ para a $4^a$ observação da tabela, em que Richness = 3 e NAP = 0.46.\n\nLembre-se que já estimamos anteriormente a variância residual destes dados ($s^2 = 7.59$). Como temos 9 observações, o valor de $t_{(\\alpha, n-2)} = 2.36$, portanto:\n\n$s_{Y|X} = \\sqrt{s^2(\\frac{1}{n} + \\frac{(X_i-\\overline{X})^2}{SQ_X})} = 0.93$\n\nO valor estimado de riqueza neste ponto é 4.75, portanto:\n\n$IC_{Y} = \\hat{Y} \\pm t_{(\\alpha, n-2)} \\times s_{Y|X} = 4.75 \\pm 2.36 \\times 0.93$\n\n$IC_{Y} = 4.75 \\pm 2.19$\n\n$IC_{Y_{limite superior}} = 6.94$\n\n$IC_{Y_{limite inferior}} = 2.56$\n\nPodemos calcular intervalos destes para todos os pontos observados como expresso na tabela abaixo.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| Richness|   NAP| $\\hat{Y}$| $s_{Y \\mid X}$| $IC_{inferior}$| $IC_{superior}$|\n|--------:|-----:|---------:|--------------:|---------------:|---------------:|\n|       13| -1.34|      9.40|           1.72|            5.34|           13.46|\n|        8|  0.64|      4.29|           0.96|            2.02|            6.56|\n|        4| -0.20|      6.46|           1.03|            4.04|            8.88|\n|        3|  0.46|      4.75|           0.93|            2.56|            6.94|\n|        6|  0.73|      4.06|           0.99|            1.73|            6.39|\n|        1|  2.22|      0.21|           1.90|           -4.29|            4.71|\n|        1|  1.38|      2.38|           1.30|           -0.70|            5.46|\n|        7| -1.00|      8.52|           1.48|            5.02|           12.02|\n|        3|  0.00|      5.94|           0.96|            3.67|            8.21|\n\n\n:::\n:::\n\n\n\n\nE representá-los graficamente, juntamente com os valores ajustados de Y.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\nNote que na figura acima, estão representados os valores observados de riqueza de espécies (em preto), os valores ajustados (azul) e os intervalos a 95% (vermelho). Os valores ajustados são aqueles utilizados para construir a **reta de regressão**. O intervalo não costuma ser representados por pontos individuais, mas por uma banda que delimita a área que restringe o intervalo de confiança ao nível $1 - \\alpha$ como na figura abaixo.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\nA banda mais estreita próxima ao ponto médio de $X$, reflete o ponto comentado anteriormente, de que quanto mais próximo ao centro da distibuição de pontos, mais confiança temos sobre os limites máximos e mínimos que um valor de $Y$ pode assumir. Do mesmo modo, esta confiança **diminui** à medida que nos aproximamos dos extremos dos valores observados em $X$. \n\n## Pressupostos da regressão linear simples\n\nAo realizar uma regressão linear simples, devemos assumir como verdadeiros alguns pressupostos.\n\n1. O modelo linear descreve adequadamente a relação funcional entre $X$ e $Y$;\n2. Cada par de observação $(X,Y)$ é independente dos demais;\n3. A variável $X$ é medida sem erros;\n4. Os resíduos têm distribuição normal, e;\n5. A variância residual $\\sigma^2$ é constante ao longo dos valores de $X$.\n\n### Relação funcional linear\n\nCaso a relação funcional entre $X$ e $Y$ assuma uma forma diferente de $Y_i = \\beta_0 + \\beta_1X_i$, o modelo de regressão não é mais válido, pois a estimativa de erro irá conter, além do componente aleatório residual, um componente **sistemático**. Este componente terá efeito sobre influência sobre a predição do modelo, sobretudo nos extremos das observações. Por modelo linear, entendemos aqueles em que os coeficientes $\\beta$ aparecem de forma aditiva. Modelos em que os componentes aparecem de outro modo na equação como potência ou no denominador de uma equação são exemplos de modelos não-lineares. Abaixo estão dois exemplos de relações **não-lineares** comumente observadas em fenômenos ambientais:\n\nEquação potência: $Y_i = \\beta_0 X_i^{\\beta_1}$\n\nModelo de Michaelis-Menten: $Y_i = \\frac{\\beta_0 X_i}{\\beta_1 + X_i}$\n\n### Independência\n\nA falta de independência pode ocorrer como resultado do delineamento amostral inapropriado para a questão em teste. A falta de independência torna crítico o uso de uma distribuição de probabilidade para o cálculo do intervalo de confiança (distribuição $t$) e para o teste de hipóteses (distribuições $t$ e $F$ ). Casos clássicos de falta de independência são aqueles em que as observações são denominadas como **pseudoréplicas** [@hurlbert1984pseudoreplication]. Após a publicação clássica de [Hurlbert](https://esajournals.onlinelibrary.wiley.com/doi/abs/10.2307/1942661), muito tem sido dito sobre pseudoreplicação. Em experimentos de campo, a falta de independência ocorre geralmente como resultados da proximidade espacial entre as réplicas ou sobre séries temporais.\n\n### Variável $X$ é medida sem erros\n\nVeja que a parcela residual do modelo de regressão se refere à distância **vertical** de $Y_i$, para um dados valor de $X$. Isto implica que os níveis de $X$ são **previamente** definidos. Quando existe variabilidade aleatória tanto em $Y$ quanto em $X$, o modelo correto para a estimativa dos parâmetros da regressão é conhecido como **Modelo II** de regressão. Este pressuposto é frequêntemente ignorado em delineamentos de regressão, sobretudo em estudos observacionais, o que não parece ser particularmente problemático.\n\n### Distribuição normal dos resíduos\n\nAssim como no pressuposto de independência, assumir que os resíduos têm uma distribuição normal permite o uso da distribuição $F$ pra o teste de hipótese e da distribuiçãio $t$ para o cálculo do intervalo de confiança. Uma distribuição de erros diferente da distribuição normal terá influência sobre o cálculo da amplitude do intervalo de confiança.\n\n### Variância residual constante\n\nCaso, a variância $\\sigma$ não seja constante ao longo da reta de regressão, o cálculo do intervalo de confiança e o resultado do teste de hipóteses são afetados. Uma vez diagnosticada uma variância **não-constante** existem modelos de regressão que podem ser apicados para incorporar este efeito em suas estimativas [@zuur2009mixed].\n\n## Diagnósticos da regressão\n\nO diagnóstivo da regressão é composto por observações e testes que ajudam a decidirmos se a regressão linear foi um bom modelo para ajustar a um conjunto de dados particular. Um bom modelo neste contexto significa um modelo que atendeu aos pressuostos descritos acima. Esta verificação passa pela observação de padrões nos **resíduos** da regressão, ou seja, pela observação da parcela estocástica do modelo.\n\n### Gráfico de resíduos\n\nO primeiro diagnóstico da regressão é  conhecido como **gráfico de resíduos**, que consiste em um gráfico de dispersão entre os resíduos e o valor ajustado $\\hat{Y}$. Abaixo estão os gráficos de resíduos que surge quando ajustamos uma reta a dados que apresentam uma **relação linear**, uma **função potência**, uma **função assintótica** e uma relação linear porém comm **variância heterogênea**.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n\n\n\nNas primeiras duas figuras, em que a relação é linear, vemos um padrão crescente de $Y$ como função de $X$ (figura da esquerda), em que os pontos estão aleatóriamente acima e abaixo da reta de regressão. Este padrão se reflete em um gráfico de resíduos (figura da direita) em que os pontos ficam aleatóriamente acima e abaixo de zero expressando resíduos positivos e negativos respectivamente. Em uma situação em que os pontos estivessem **perfeitamente** sobre a reta, os resíduos seriam todos iguais a zero e o gráfico de resíduos mostraria todos os pontos alinhados horizontalmente em zero.\n\nQuando a relação é potência e tentamos ajustar uma reta sobre, vemos que inicialmente os resíduos sao positivos, o seja, estão acima da reta. Os resíduos se tornam negativos no centro da nuvem de pontos e novamente positivos ao final do gráfico. Este padrão é mais evidente no gráfico de resíduos, que mostra um componente **sistemático** dos resíduos como fução do valor ajustado. Ao usar uma regressão linear neste caso, iríamos subestimar **consistentemente** os valores de Y nos extremos da figura e superestimlá-los no trecho central.  Portanto, uma reta de regressão, quando ajustada a um conjunto de dados que expressa um padrão **não-linear**, não é capaz de isolar adequadamente as parcelas aleatórias e sistemáticas da relação entre $Y$ e $X$. Isto pode ser corrigido aplicando-se uma regressão **não-linear** aos dados.\n\nQuando a relação é assintótica, o resultado do ajuste foi inverso ao anterior. De fato, resultados análogos serão observados senpre que tentarmos ajustra uma regressão linear a dados que expressam padrões não-lineares.\n\nNo último exemplo (variância heterogênea) os pontos tendem a se afastar consistentemente da reta de regressão conforme aumentam os valores de $X$. Isto denota que o pressuposto de variância $\\sigma^2$ constante não é válido nesta relação. Isto pode ser corrigido aplicando-se um modelo de regressão linear com variância heterogênea.\n\n### Histograma dos resíduos\n\nOutro diagnóstico da regressão consiste em fazer um histograma dos gráficos de resíduos. Um histograma, aproximadamente simétrico ao redor de zero o que sugere que o pressuposto de normalidade dos resíduos é válido neste caso. Existem testes formais de normalidade cmo o teste de **Kolmogorov Smirnov** ou o teste de **Shapiro-Wilk**.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](regressao-linear-simples_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "regressao-linear-simples_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}