{
  "hash": "663854240441faa6c38eee86e8f4ccfa",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Modelos Estatísticos e Modelos Científicos\"\nsubtitle: \"Complexidade Tecnológica em Ilhas da Oceania\"\ndescription: \"Três estratégias para modelar a relação entre tamanho populacional e número de ferramentas\"\nCategories: [\n        \"PyMC\",\n        \"GLM\",\n        \"Regressão linear\",\n        \"Modelo não linear\",\n        \"Regressão de Poisson\"\n        ]\nimage: \"images/regressao-poisson.png\"\nexecute:\n    echo: true\n    eval: true\n    warning: false\n    message: false\n\n---\n\n\n\n\nVamos utilizar modelos estatísticos para analisar a **complexidade tecnológica tradicional em ilhas da Oceania** [@kline2010population]. Nosso objetivo é compreender como o **tamanho populacional** influenciou o **número de ferramentas** disponíveis em cada sociedade. \n\nCompararemos **três estratégias de modelagem**, todas implementadas com **PyMC**:\n\n1. **Modelo Linear com Transformação Logarítmica**: Utilizando regressão linear após transformar as variáveis\n2. **Modelo Linear Generalizado (GLM)**: Especificamente regressão de Poisson para dados de contagem\n3. **Modelo Científico (Mecanicista)**: Baseado em uma descrição teórica da dinâmica de aquisição e perda de ferramentas [@mcelreath2018statistical]\n\n## Analisando o conjunto de dados\n\nImporte os dados [kline.csv](https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/kline.csv).\n\n::: {#d2377984 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pymc as pm\nimport bambi as bmb\nimport arviz as az\nimport xarray as xr\n```\n:::\n\n\n::: {#c4a4c372 .cell execution_count=2}\n``` {.python .cell-code}\nkline = pd.read_csv('https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/kline.csv')\nkline\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>culture</th>\n      <th>population</th>\n      <th>contact</th>\n      <th>total_tools</th>\n      <th>mean_TU</th>\n      <th>lat</th>\n      <th>lon</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Malekula</td>\n      <td>1100</td>\n      <td>low</td>\n      <td>13</td>\n      <td>3.2</td>\n      <td>-16.3</td>\n      <td>167.5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Tikopia</td>\n      <td>1500</td>\n      <td>low</td>\n      <td>22</td>\n      <td>4.7</td>\n      <td>-12.3</td>\n      <td>168.8</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Santa Cruz</td>\n      <td>3600</td>\n      <td>low</td>\n      <td>24</td>\n      <td>4.0</td>\n      <td>-10.7</td>\n      <td>166.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Yap</td>\n      <td>4791</td>\n      <td>high</td>\n      <td>43</td>\n      <td>5.0</td>\n      <td>9.5</td>\n      <td>138.1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Lau Fiji</td>\n      <td>7400</td>\n      <td>high</td>\n      <td>33</td>\n      <td>5.0</td>\n      <td>-17.7</td>\n      <td>178.1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Trobriand</td>\n      <td>8000</td>\n      <td>high</td>\n      <td>19</td>\n      <td>4.0</td>\n      <td>-8.7</td>\n      <td>150.9</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Chuuk</td>\n      <td>9200</td>\n      <td>high</td>\n      <td>40</td>\n      <td>3.8</td>\n      <td>7.4</td>\n      <td>151.6</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Manus</td>\n      <td>13000</td>\n      <td>low</td>\n      <td>28</td>\n      <td>6.6</td>\n      <td>-2.1</td>\n      <td>146.9</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Tonga</td>\n      <td>17500</td>\n      <td>high</td>\n      <td>55</td>\n      <td>5.4</td>\n      <td>-21.2</td>\n      <td>-175.2</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Hawaii</td>\n      <td>275000</td>\n      <td>low</td>\n      <td>71</td>\n      <td>6.6</td>\n      <td>19.9</td>\n      <td>-155.6</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nVisualize a relação entre tamanho populacional (P) e número total de ferramentas (T).\n\n::: {#cell-fig-tools-pop .cell .fig-cap-location-bottom execution_count=3}\n``` {.python .cell-code}\n# Definir tema com fonte maior\nplt.figure(figsize=(8, 6))\nsns.scatterplot(data=kline, x='population', y='total_tools', \n                s=100, alpha=0.7, color='#1f77b4')\n\n# Personalização dos rótulos e tema\nplt.xlabel('Tamanho populacional', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nsns.set_theme(style=\"whitegrid\")\n\n```\n\n::: {.cell-output .cell-output-display}\n![Relação entre o número total de ferramentas e o tamanho populacional em ilhas na Oceania](regressao-poisson_files/figure-html/fig-tools-pop-output-1.png){#fig-tools-pop width=665 height=509}\n:::\n:::\n\n\n## Estratégia 1: Regressão Linear com Transformação Logarítmica\n\nA relação na @fig-tools-pop é claramente não linear e pode ser descrita por:\n\n$$T = \\beta_0P^{\\beta_1}$$\n\nUma alternativa simples neste caso é utilizar uma transformação logarítmica para *linearizar* a expressão:\n\n$$\\log(T) = \\log(\\beta_0P^{\\beta_1}) \\Rightarrow \\log(T) = \\log(\\beta_0) + \\log(P^{\\beta_1}) \\Rightarrow$$\n\n$$\\log(T) = B_0 + \\beta_1 \\log(P)\n$${#eq-logT-logP}\n\nem que $B_0 = \\log(\\beta_0)$\n\nVisualizando na escala logarítmica:\n\n::: {#fig-log-tools-pop .cell .fig-cap-location-bottom execution_count=4}\n``` {.python .cell-code}\nkline['log_tools'] = np.log(kline['total_tools'])\nkline['log_pop'] = np.log(kline['population'])\n\nplt.figure(figsize=(8, 6))\nsns.scatterplot(data=kline, x='log_pop', y='log_tools', \n                s=100, alpha=0.7, color='#1f77b4')\n\n# Personalização dos rótulos e tema\nplt.xlabel('log do Tamanho populacional', fontsize=14)\nplt.ylabel('log do Número total de ferramentas', fontsize=14)\n```\n\n::: {#fig-log-tools-pop-1 .cell-output .cell-output-display execution_count=4}\n```\nText(0, 0.5, 'log do Número total de ferramentas')\n```\n\nRelação entre o logarítmo do número total de ferramentas e o logarítmo do tamanho populacional\n:::\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/fig-log-tools-pop-output-2.png){#fig-log-tools-pop-2 width=684 height=513}\n:::\n:::\n\n\nConsiderando que a relação na @fig-log-tools-pop é aproximadamente linear, vamos ajustar o modelo de regressão linear descrito na @eq-logT-logP.\n\nNeste modelo, estamos assumindo que $\\log(T)$ é uma variável aleatória normnalmente distribuída:\n\n$$\\log(T) \\sim \\mathcal{N}(\\mu,\\,\\sigma)$$\n\n$$\\mu = B_0 + \\beta_1 \\log(P)$$\n\n### Implementação\n\n::: {#0d10a874 .cell execution_count=5}\n``` {.python .cell-code}\nmlinear = bmb.Model(\"log_tools ~ log_pop\", data=kline)\ntrace_linear = mlinear.fit()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"810b0ea8eac34cae882eb9da13abcaf2\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\n::: {#998d0d88 .cell execution_count=6}\n``` {.python .cell-code}\n# Resumo dos parâmetros\naz.summary(trace_linear)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_3%</th>\n      <th>hdi_97%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>sigma</th>\n      <td>0.368</td>\n      <td>0.104</td>\n      <td>0.209</td>\n      <td>0.560</td>\n      <td>0.002</td>\n      <td>0.003</td>\n      <td>2206.0</td>\n      <td>2375.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>Intercept</th>\n      <td>1.018</td>\n      <td>0.756</td>\n      <td>-0.375</td>\n      <td>2.499</td>\n      <td>0.015</td>\n      <td>0.019</td>\n      <td>2817.0</td>\n      <td>2172.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop</th>\n      <td>0.269</td>\n      <td>0.083</td>\n      <td>0.117</td>\n      <td>0.430</td>\n      <td>0.002</td>\n      <td>0.002</td>\n      <td>2828.0</td>\n      <td>2080.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Gerando predições do modelo linear\n\n::: {#6b477216 .cell execution_count=7}\n``` {.python .cell-code}\npred_linear = mlinear.predict(trace_linear, kind = 'response', data = kline, inplace=False)\npred_linear_draws = pred_linear.posterior_predictive.log_tools\npred_linear_mean = pred_linear_draws.mean(dim=['chain', 'draw'])\n```\n:::\n\n\n### Visualização do modelo linear\n\n::: {#e6fd7b4c .cell execution_count=8}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 6))\nsns.scatterplot(data=kline, x='log_pop', y='log_tools', \n                s=100, alpha=0.7, color='#1f77b4')\n\nplt.plot(kline['log_pop'],pred_linear_mean.values, color='red', linewidth=2, label='Predição média')\naz.plot_hdi(\n    kline['log_pop'],\n    pred_linear.posterior_predictive.log_tools,\n    hdi_prob=0.95, # Intervalo de 95%\n    color='#f3ae1a',\n    fill_kwargs={'alpha': 0.3, 'label': 'Intervalo de Credibilidade (95%)'}\n)\n\nplt.xlabel('log(População)', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.title('Modelo de linear: log_tools ~ log_pop', fontsize=16)\nplt.legend()\nplt.grid(True, alpha=0.3)\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-9-output-1.png){width=674 height=538}\n:::\n:::\n\n\n#### Visualização do modelo linear na escala original\n\nComo a escala original é um modelo não linear, teremos que gerar os valores preditos para mais pontos a partir dos parâmetros estimaos\n\n::: {#53759cf3 .cell execution_count=9}\n``` {.python .cell-code}\nlog_pop = np.linspace(min(kline['log_pop']), np.max(kline['log_pop']), num=1000)\nnew_x =  xr.DataArray(\n    log_pop,\n    dims=['obs'],\n    coords={'obs': range(len(log_pop))},\n    name='log_pop'\n)\n\nmlinear_pars = mlinear.predict(trace_linear, kind = 'response_params', data = kline, inplace=False)\n\nB0 = mlinear_pars.posterior['Intercept']\nb1 = mlinear_pars.posterior['log_pop']\nnew_pred_linear_mean = B0.values.mean() + b1.values.mean() * new_x\n\nnew_pred_linear = np.exp(B0 + b1 * new_x)\nic_linear = az.hdi(new_pred_linear, hdi_prob=0.95)\n```\n:::\n\n\n::: {#b73e9f8f .cell execution_count=10}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 6))\nsns.scatterplot(data=kline, x='population', y='total_tools', \n                s=100, alpha=0.7, color='#1f77b4')\n\nplt.plot(np.exp(new_x),np.exp(new_pred_linear_mean))\n\nplt.fill_between(np.exp(new_x),\n                 ic_linear.sel(hdi='lower')['x'],\n                 ic_linear.sel(hdi='higher')['x'],\n                 alpha=0.3, color='#f3ae1a', \n                 label='HDI 95%')\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-11-output-1.png){width=676 height=510}\n:::\n:::\n\n\n## Estratégia 2: Regressão de Poisson (GLM)\n\nEmbora a transformação logarítmica torne linear a porção determinística do modelo, ela não resolve adequadamente a natureza discreta da variável de resposta. No caso do número de ferramentas (`total_tools`), estamos lidando com dados de contagem — valores inteiros não negativos. Uma abordagem mais apropriada é utilizar uma **regressão de Poisson**, que modela diretamente a distribuição da variável como uma variável aleatória de contagem.\n\nVamos assumir que o que realmente influencia a diversidade tecnológica não é o tamanho absoluto da população, mas sim sua **ordem de grandeza** [@kline2010population]. Espera-se, portanto, uma associação positiva entre o número de ferramentas e o logaritmo do tamanho populacional.\n\nEste modelo generativo pode ser descrito como:\n\n$$T_i \\sim \\text{Poisson}(\\lambda_i)$$\n\n$$\\log(\\lambda_i) = \\beta_0 + \\beta_1 \\cdot \\log(P_i)$$\n\nOnde:\n* $T_i$ é o número de ferramentas na sociedade *i*\n* $P_i$ é o tamanho populacional\n* A função de ligação logarítmica garante que $\\lambda_i > 0$\n\n### Implementação\n\n::: {#388d6e45 .cell execution_count=11}\n``` {.python .cell-code}\nmpoisson = bmb.Model(\"total_tools ~ log_pop\", \n                     data=kline, \n                     family=\"poisson\")\n```\n:::\n\n\n::: {#7f6bea6b .cell execution_count=12}\n``` {.python .cell-code}\ntrace_poisson = mpoisson.fit(draws=2000, tune=1000)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"127b2e02e7e04627be3daaed5a218e72\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\n::: {#0394dece .cell execution_count=13}\n``` {.python .cell-code}\n# Resumo dos parâmetros\naz.summary(trace_poisson)\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_3%</th>\n      <th>hdi_97%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>1.334</td>\n      <td>0.301</td>\n      <td>0.760</td>\n      <td>1.890</td>\n      <td>0.004</td>\n      <td>0.003</td>\n      <td>7127.0</td>\n      <td>5501.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop</th>\n      <td>0.239</td>\n      <td>0.031</td>\n      <td>0.181</td>\n      <td>0.295</td>\n      <td>0.000</td>\n      <td>0.000</td>\n      <td>7194.0</td>\n      <td>5795.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Gerando predições do modelo Poisson\n\n::: {#6bee2fdc .cell execution_count=14}\n``` {.python .cell-code}\n# Predições para os dados originais\npred_poisson = mpoisson.predict(trace_poisson, kind='response', data=kline, inplace=False)\npred_poisson_draws = pred_poisson.posterior_predictive.total_tools\npred_poisson_mean = pred_poisson_draws.mean(dim=['chain', 'draw'])\n```\n:::\n\n\n::: {#dcb8a140 .cell execution_count=15}\n``` {.python .cell-code}\n# Criar dados para predição suave\nlog_pop_new = np.linspace(min(kline['log_pop']), max(kline['log_pop']), num=100)\nnew_data = pd.DataFrame({'log_pop': log_pop_new})\n\n# Gerar predições\nnew_pred_poisson = mpoisson.predict(trace_poisson, kind='response', data=new_data, inplace=False)\nnew_pred_poisson_mean = new_pred_poisson.posterior_predictive.total_tools.mean(dim=['chain', 'draw'])\n```\n:::\n\n\n### Visualização do modelo Poisson\n\n::: {#be5934f9 .cell execution_count=16}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 6))\n\n# Pontos originais\nsns.scatterplot(data=kline, x='log_pop', y='total_tools', \n                s=100, alpha=0.7, color='#1f77b4', label='Dados observados')\n\n# Linha de predição média\nplt.plot(log_pop_new, new_pred_poisson_mean.values, \n         color='red', linewidth=2, label='Predição média')\n\n# Intervalo de credibilidade\naz.plot_hdi(\n    log_pop_new,\n    new_pred_poisson.posterior_predictive.total_tools,\n    hdi_prob=0.95,\n    color='#f3ae1a',\n    fill_kwargs={'alpha': 0.3, 'label': 'HDI 95%'}\n)\n\nplt.xlabel('log(População)', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.title('Modelo de Poisson: total_tools ~ log_pop', fontsize=16)\nplt.legend()\nplt.grid(True, alpha=0.3)\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-17-output-1.png){width=679 height=538}\n:::\n:::\n\n\n### Visualização na escala original (população)\n\n::: {#efbbea0a .cell execution_count=17}\n``` {.python .cell-code}\nplt.figure(figsize=(12, 8))\n\nsns.scatterplot(data=kline, x='population', y='total_tools', \n                s=100, alpha=0.7, color='black', label='Dados observados')\n\nplt.plot(np.exp(log_pop_new), new_pred_poisson_mean.values, \n         color='blue', linewidth=2, linestyle='--', label='Modelo Poisson')\naz.plot_hdi(\n    np.exp(log_pop_new),\n    new_pred_poisson.posterior_predictive.total_tools,\n    hdi_prob=0.95,\n    color='#1f77b4',\n    fill_kwargs={'alpha': 0.3, 'label': 'HDI 95% Poisson'},\n)\n\nplt.xlabel('População', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.title('Comparação de Modelos', fontsize=16)\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-18-output-1.png){width=1136 height=753}\n:::\n:::\n\n\n### Comparação com modelo linear\n\n::: {#8e93deed .cell execution_count=18}\n``` {.python .cell-code}\nplt.figure(figsize=(12, 8))\n\nsns.scatterplot(data=kline, x='population', y='total_tools', \n                s=100, alpha=0.7, color='black', label='Dados observados')\n\n# Modelo Linear com transformação log (escala original)\nplt.plot(np.exp(new_x), np.exp(new_pred_linear_mean), \n         color='red', linewidth=2, label='Modelo Linear')\nplt.fill_between(np.exp(new_x),\n                 ic_linear.sel(hdi='lower')['x'],\n                 ic_linear.sel(hdi='higher')['x'],\n                 alpha=0.3, color='#f3ae1a', \n                 label='HDI 95% Linear')\n\n# Modelo Poisson (GLM)\nplt.plot(np.exp(log_pop_new), new_pred_poisson_mean.values, \n         color='blue', linewidth=2, linestyle='--', label='Modelo Poisson')\naz.plot_hdi(\n    np.exp(log_pop_new),\n    new_pred_poisson.posterior_predictive.total_tools,\n    hdi_prob=0.95,\n    color='#1f77b4',\n    fill_kwargs={'alpha': 0.3, 'label': 'HDI 95% Poisson'},\n)\n\nplt.xlabel('População', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.title('Comparação de Modelos', fontsize=16)\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-19-output-1.png){width=1136 height=753}\n:::\n:::\n\n\n## Estratégia 3: Modelo Científico (Mecanicista)\n\nPartindo de uma descrição teórica da dinâmica de inovação tecnológica, podemos expressar a mudança esperada no número de ferramentas ao longo do tempo como:\n\n$$\\Delta T = \\alpha P^\\beta - \\gamma T$$\n\nOnde:\n* $P$ é o tamanho da população\n* $T$ é o número de ferramentas\n* $\\alpha$, $\\beta$ e $\\gamma$ são parâmetros a serem estimados\n* $\\alpha P^\\beta$ representa a taxa de inovação (dependente da população)\n* $\\gamma T$ representa a taxa de perda de ferramentas\n\nAssumindo que o sistema está em equilíbrio ($\\Delta T = 0$), podemos resolver para $T$:\n\n::: {.callout-note title=\"Situação de equilíbrio\"}\n\nComeçamos com:\n$$0 = \\alpha P^\\beta - \\gamma T$$\n\nIsolando o termo $T$:\n$$\\gamma T = \\alpha P^\\beta$$\n\nDividindo ambos os lados por $\\gamma$:\n$$T = \\frac{\\alpha P^\\beta}{\\gamma}\n$${#eq-delta-T-equilibrio}\n\n:::\n\nIncorporando a @eq-delta-T-equilibrio a um modelo de Poisson:\n\n$$T_i \\sim \\text{Poisson}(\\lambda_i)$$\n\n$$\\lambda_i = \\frac{\\alpha P_i^{\\beta}}{\\gamma}$$\n\n### Implementação em PyMC\n\nPara facilitar a implementação, vamos reparametrizar usando:\n\n$$\\log(\\lambda_i) = \\log(\\alpha) + \\beta \\cdot \\log(P_i) - \\log(\\gamma)$$\n\nou equivalentemente:\n\n$$\\log(\\lambda_i) = \\theta_\\alpha + \\beta \\cdot \\log(P_i) + \\theta_\\gamma$$\n\nonde $\\theta_\\alpha = \\log(\\alpha)$ e $\\theta_\\gamma = -\\log(\\gamma)$.\n\n::: {#58457061 .cell execution_count=19}\n``` {.python .cell-code}\nlog_pop = np.log(kline['population'])\ntools = kline['total_tools'].values\n\nwith pm.Model() as scientific_model:\n    # Priors\n    theta_alpha = pm.Normal(\"theta_alpha\", mu=0, sigma=2)\n    beta = pm.Normal(\"beta\", mu=0, sigma=1)\n    theta_gamma = pm.Normal(\"theta_gamma\", mu=0, sigma=1)\n\n    # Esperança em escala log\n    log_lambda = theta_alpha + beta * log_pop + theta_gamma\n    lambda_ = pm.math.exp(log_lambda)\n\n    # Likelihood\n    T_obs = pm.Poisson(\"total_tools\", mu=lambda_, observed=tools)\n\n    # Amostragem\n    trace_scientific = pm.sample(2000, tune=1000, target_accept=0.95)\n    pm.compute_log_likelihood(trace_scientific)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"dde407bb05244ec8b5256b4c5e156490\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"95cec2cfebd14e0ca7bcbbdb254f585b\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\n::: {#ef84b8a9 .cell execution_count=20}\n``` {.python .cell-code}\naz.summary(trace_scientific, var_names=[\"theta_alpha\", \"beta\", \"theta_gamma\"], hdi_prob=0.89)\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_5.5%</th>\n      <th>hdi_94.5%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>theta_alpha</th>\n      <td>1.068</td>\n      <td>0.955</td>\n      <td>-0.523</td>\n      <td>2.524</td>\n      <td>0.021</td>\n      <td>0.015</td>\n      <td>2058.0</td>\n      <td>2524.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>beta</th>\n      <td>0.241</td>\n      <td>0.032</td>\n      <td>0.193</td>\n      <td>0.293</td>\n      <td>0.001</td>\n      <td>0.001</td>\n      <td>2906.0</td>\n      <td>2656.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>theta_gamma</th>\n      <td>0.248</td>\n      <td>0.926</td>\n      <td>-1.159</td>\n      <td>1.818</td>\n      <td>0.021</td>\n      <td>0.014</td>\n      <td>2024.0</td>\n      <td>2427.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Gerando predições do modelo científico\n\n::: {#617dd67d .cell execution_count=21}\n``` {.python .cell-code}\nposterior = trace_scientific.posterior\n\n# Recuperar parâmetros transformados\nalpha_samples = np.exp(posterior['theta_alpha'])\nbeta_samples = posterior['beta']\ngamma_samples = np.exp(-posterior['theta_gamma'])\n\n# Grid de população para predições\npop_pred = np.linspace(kline['population'].min(), kline['population'].max(), 200)\n\n# Calcular predições usando a fórmula científica\npred_samples = []\nfor i in range(len(alpha_samples.chain)):\n    for j in range(len(alpha_samples.draw)):\n        alpha_val = alpha_samples.isel(chain=i, draw=j).values\n        beta_val = beta_samples.isel(chain=i, draw=j).values\n        gamma_val = gamma_samples.isel(chain=i, draw=j).values\n        \n        pred = (alpha_val * (pop_pred ** beta_val)) / gamma_val\n        pred_samples.append(pred)\n\npred_samples = np.array(pred_samples)\n\n# Calcular estatísticas\nmean_scientific = pred_samples.mean(axis=0)\nhdi_scientific = az.hdi(pred_samples, hdi_prob=0.89)\n```\n:::\n\n\n## Comparação dos Três Modelos\n\nVamos comparar as predições dos três modelos em um único gráfico:\n\n::: {#8a685f32 .cell execution_count=22}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 6))\n\n# Dados observados (plotados apenas uma vez)\nsns.scatterplot(data=kline, x='population', y='total_tools', \n                s=100, alpha=0.7, color='black', label='Dados observados')\n\n# 1. Modelo Linear com transformação log (escala original)\nplt.plot(np.exp(new_x), np.exp(new_pred_linear_mean), \n         color='red', linewidth=2, label='Modelo Linear')\nplt.fill_between(np.exp(new_x),\n                 ic_linear.sel(hdi='lower')['x'],\n                 ic_linear.sel(hdi='higher')['x'],\n                 alpha=0.3, color='#f3ae1a', \n                 label='IC 95% Linear')\n\n# 2. Modelo Poisson (GLM)\nplt.plot(np.exp(log_pop_new), new_pred_poisson_mean.values, \n         color='blue', linewidth=2, linestyle='--', label='Modelo Poisson')\naz.plot_hdi(\n    np.exp(log_pop_new),\n    new_pred_poisson.posterior_predictive.total_tools,\n    hdi_prob=0.95,\n    color='#1f77b4',\n    fill_kwargs={'alpha': 0.3, 'label': 'IC 95% Poisson'},\n)\n\n# 3. Modelo Científico (Mecanicista)\n# Modelo Científico\nplt.plot(pop_pred, mean_scientific, color='#2ca02c', linewidth=3, \n         label='Modelo Mecanicista')\nplt.fill_between(pop_pred, hdi_scientific[:, 0], hdi_scientific[:, 1],\n                 color='#2ca02c', alpha=0.2, label = 'IC Mecanicista) 95%')\n\n# Configurações do gráfico\nplt.xlabel('População', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.title('Comparação dos Três Modelos', fontsize=16)\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-23-output-1.png){width=752 height=559}\n:::\n:::\n\n\n",
    "supporting": [
      "regressao-poisson_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"127b2e02e7e04627be3daaed5a218e72\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_f0ccef772e864e88ad8955079ac6ba77\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                 </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed  </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.95        3            3600.58 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.02        3            3550.12 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.02        1            3229.77 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.24        1            2729.11 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.95        3            3600.58 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.02        3            3550.12 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.02        1            3229.77 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.24        1            2729.11 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"7fa14893b5914c80bd39962c4fa9c23f\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"810b0ea8eac34cae882eb9da13abcaf2\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_7fa14893b5914c80bd39962c4fa9c23f\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                 </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed  </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   2000    0             0.65        3            2617.98 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   2000    0             0.62        7            2589.30 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   2000    0             0.80        3            2379.99 draws/s   0:00:00   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   2000    0             0.84        3            2432.16 draws/s   0:00:00   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   2000    0             0.65        3            2617.98 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   2000    0             0.62        7            2589.30 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   2000    0             0.80        3            2379.99 draws/s   0:00:00   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   2000    0             0.84        3            2432.16 draws/s   0:00:00   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"95cec2cfebd14e0ca7bcbbdb254f585b\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_ea99c983d8ae46d59c6d4bcc49435a57\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">Computing ... <span style=\\\"color: #008000; text-decoration-color: #008000\\\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\\\"color: #800080; text-decoration-color: #800080\\\">100%</span> 0:00:00\\n</pre>\\n\",\"text/plain\":\"Computing ... \\u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m \\u001b[35m100%\\u001b[0m 0:00:00\\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"d87887e05212440a904071ab0c486df0\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"dde407bb05244ec8b5256b4c5e156490\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_d87887e05212440a904071ab0c486df0\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.05        127          360.94 draws/s   0:00:08   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.05        127          348.48 draws/s   0:00:08   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.04        43           377.70 draws/s   0:00:07   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.05        63           384.76 draws/s   0:00:07   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.05        127          360.94 draws/s   0:00:08   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.05        127          348.48 draws/s   0:00:08   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.04        43           377.70 draws/s   0:00:07   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.05        63           384.76 draws/s   0:00:07   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"ea99c983d8ae46d59c6d4bcc49435a57\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"f0ccef772e864e88ad8955079ac6ba77\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}